<!-- saved from url=(0022)http://internet.e-mail -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link href='../css/pageframe.css' type='text/css' rel='stylesheet'>
<link href='../css/apps.css' type='text/css' rel='stylesheet' id="framecssfile">
<script type='text/javascript' src='../js/jquery.tools.min.js'></script>	
<script type="text/javascript" src='../js/jquery.cookie.js'></script>
<script type="text/javascript" src='../js/jquery.prompt.js'></script>
<script type="text/javascript" src='../js/jquery.stylish-select.min.js'></script>
<!--[if lt IE 10]>
<script type="text/javascript" src="../js/PIE.js"></script>
<![endif]-->
<style>
.itemdiv, .detailcontent{padding-left:16px;}
.detailcontent{width:370px;}
.detailcontent .hoverItem{background:#FCF8F5;}
.editdiv{display:block;margin-top:8px;}
.acctselect{width:230px;height:26px;float:left;}
.newListSelected{margin-top:0 !important;margin-bottom:12px;}
.newListSelected div, .newList{text-align:left;}
.itemname{width:165px;margin-left:10px;}
.itemnametopchild, .itemnamebotchild, .itemdatechild{display:block;float:left;width:100%;text-overflow: ellipsis;white-space:nowrap;overflow:hidden;}
.itemnametopchild{height:15px;margin-top:13px;line-height:14px;font-size:14px;text-align:bottom;}
.itemnamebotchild{height:12px;line-height:12px;font-size:12px;display:none;}
.itemdatechild{height:21px;line-height:21px;font-size:12px;color:#666;}
.itemnumber{margin-left:5px;margin-right:2px;width:140px;color:#666;text-align:right;}
.itemnumbertop{height:19px;line-height:19px;margin-top:1px;}
.itemdiv .itemname{width:180px;}
.itemdiv .itemnumber{width:90px;margin-left:12px;text-align:right;}
.missednum{color:red;}
#logitemsdiv{float:left;min-width:200px;overflow-x:hidden;overflow-y:auto;}
#logitemsdiv .videoicon,#logitemsdiv .audioicon{margin-right:6px;}
.logiteminfodiv{width:315px;height:34px;display:block;}
.logitemtopdiv, .logitembotdiv{width:310px;display:block;}
.logitemtopdiv{height:15px;}
.logitembotdiv{min-height:15px;margin-bottom:10px;}
.logitemdate{width:140px;height:34px;}
.logitemtopdate{width:160px;height:34px;}
.logitemdate{line-height:34px;margin-left:0px;}
.logitemduration, .logitemtopduration{width:120px;height:34px;line-height:34px;margin-left:6px;}
.logitemtopdate, .logitemtopduration{height:17px;line-height:17px;}
.logitemmembers{width:100%;height:17px;line-height:17px;white-space:nowrap;word-wrap: break-word;word-break:break-all;overflow:hidden;text-overflow:ellipsis;}
.delicondiv{width:23px;height:23px;margin-top:5px;margin-left:2px;}
.logitemtopdiv .delicondiv{margin-top:0px;}
.delicon, #itemdelbtn{width:30px;height:30px;min-width:0px;background:url("../img/apps/call_status_icons.png") -120px 0 no-repeat;border:none;}
.delicon:hover, #itemdelbtn.buttonover{background:url("../img/apps/call_status_icons.png") -150px 0 no-repeat;}
#addtocontact, #rightaddtocontact{width:30px;height:30px;min-width:0px;margin-left:10px;background:url("../img/apps/call_status_icons.png") -240px 0 no-repeat;border:none;}
#addtocontact:hover, #rightaddtocontact:hover{background:url("../img/apps/call_status_icons.png") -270px -0 no-repeat;}
#addtoschedule{width:30px;height:30px;min-width:0px;margin-left:10px;background:url("../img/apps/call_status_icons.png") -180px 0 no-repeat;border:none;}
#addtoschedule:hover{background:url("../img/apps/call_status_icons.png") -210px 0 no-repeat;}
.titleboot{text-overflow: ellipsis;white-space:nowrap;overflow:hidden;}
#divcallbtn, #rightdivcallbtn{margin-top:3px;margin-left:2px;position:relative;right:40px;top:0;width:130px;height:34px;background:#FFFFFF;padding-top:0;text-align:right;float: right;}
#divcallbtn{*width:110px;*right:20px;}
#rightdivcallbtn{right:45px;margin-top:3px;background:#FCF8F5;}
.itemdiv, .rightitemdiv{width:382px;}
.rightitemdiv .itemname{width:165px;margin-left:2px;}
.delcontacticon{width:20px;height:20px;padding:0;border:0;top:2px;float:right;*float:none;*top:0px;min-width:0px;background:transparent url(../img/apps/call_status_icons.png) -20px -157px no-repeat;position:relative;}

.namedividerdiv{display:block;float:left;width:140px;margin-left:5px;}
.memberitemdiv{display:none;}
.itemmembericon{width:20px;display:block;float:left;margin-top:13px;}
.itemarrow{width:7px;height:11px;margin:0 6px 0 0;}
.rightarrowicon{width:5px;height:11px;background:transparent url(../img/apps/app_more_triangle_normal.png) center center no-repeat;border:none;margin-top: 11px;}
.downarrowicon{width:7px;height:8px;background:transparent url(../img/apps/app_more_triangle_pressed.png) center center no-repeat;border:none;margin-top: 10px;}
.audioicon{width:13px;height:16px;background:url("../img/apps/call_status_icons.png") -13px -90px no-repeat;margin-left:1px;}
.videoicon{width:13px;height:16px;background:url("../img/apps/call_status_icons.png") 0px -90px no-repeat;}
.membernamespan{width:120px;line-height:32px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;display:inline-block;}
.editdiv input[type="text"]{width:248px;margin-top:0px;float: left;}
.detailnumdiv, .detailemaildiv{height:auto;}
input[type="text"].numinput{margin-top:2px;}
#addnewnumspan, #addnewemailspan{margin-right:5px;}
.addnumicon,.addemailicon{width:20px;height:20px;padding:0;border:0;top:11px;float:right;*float:none;*top:2px;min-width:0px;background:transparent url(../img/apps/call_status_icons.png) 0 -157px no-repeat;position:relative;}
.editdiv{width:280px;}
.desdiv{width:70px;}
.logitemdiv{margin-top:10px;}
#addgroups span{width:215px;height:30px;line-height:40px;*line-height:30px;margin-left:15px;display:inline-block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
#newgrouppopdiv{width:400px;height:150px;position:absolute;left:180px;top:100px;background:#F6F7F7;color:#FFF;font-size:16px;box-shadow:0px 0px 10px 2px #919191;}
#newgrouppopdiv .titlediv{width:auto;height:35px;line-height:35px;background:#1D6EA8;padding-left:15px;color:#FFF;font-weight:normal;}
#newgrouppopdiv button{width:82px;}
#addnewgroup{margin-right: 48px;}
#addnewnumspan, #addnewemailspan{margin-right:5px;}
#a_detailgroups{display:inline-block;margin-top:5px;}
#newgroupbtn{margin-top: 5px;}
/*.itemicon img{vertical-align:middle;margin:10px 0 0 0;}*/

/*select members when number of conf member more than 8*/
#selectcalldiv{width:400px;height:auto;position:absolute;top:40%;margin-top:-180px;left:50%;margin-left:-200px;z-index:1000;background:#F6F7F7;color:#FFF;font-size:16px;box-shadow:0px 0px 10px 2px #919191;display:none;}
.selecttitle{width:auto;height:35px;line-height:35px;background:#1D6EA8;padding-left:15px;}
.selecttitle span{float: left;}
#selectlist{color:#222;height:340px;overflow-y:auto;}
.selectbtn{text-align:center;height:50px;position:relative;*z-index:-1;}
.selectbtn button{margin:8px 0 0 15px;}
#selectcalldiv #closecalldiv{width:24px;height:24px;min-width:0px;border:0;background:url("../img/call/close_incomingcall.png") center center transparent no-repeat;border-radius:0px;float:right;margin:5px 5px 0 0;}
#selectcalldiv #closecalldiv.buttonover{background-color:#E32632;}
#selectcall{width:100px;height:30px;background:#4ABE6B;position:relative;}
#selectcall.buttonover{background-color:#32A553;}
#selectcancel{width:100px;height:30px;position:relative;margin-left:48px;}
#selectlist div{width:330px;margin-left:45px;height:30px;margin-top:7px;}
#selectlist div span{width:130px;margin-left:15px;display:inline-block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.selecttips{color:red;width:100%;height:20px;text-align: center;}
</style>
<body id="framebody" class="maintenancebody">
<div id="mainbody" class="maindiv appmaindiv">
    <div id="leftdiv" class="appleft">
        <div webtip="" id="itemsdiv">
            <div id="divcallbtn"><input type="button" id="itemdelbtn" style="display:none;" /><input type="button" id="addtocontact" /><input type="button" id="addtoschedule" /><input type="button" id="itemcallbtn" style="margin-left:10px;"/></div>
            <div id="loadmorediv" style="text-align:center;padding-left:3px;display:none;">
                <button id="loadmorelogs" style="cursor: pointer;background:#E6E5E5;width:200px;color:#999999;font-size:14px;margin-top:6px;">Loading More</button>
            </div>
        </div>
        <div class="appsbtn">
            <input type="checkbox" id="selectall" class="selectall" />
            <button id="delcontact" style="display:none;">Delete</button>
        </div>  
    </div>
    <div id="rightdiv" class="appright">
        <div class="titlediv">
            <div class="titleboot"><span id="a_detailstitle"></span></div>
        </div>
        <div id="logitemsdiv" class="detailcontent" style="display:none;padding-left:0px;width:382px;">
            <div id="rightdivcallbtn" style="display:none;"><input type="button" id="rightaddtocontact" /><input type="button" id="rightitemcallbtn" style="margin-left:10px;margin-top:3px;"/></div>
        </div>
        <div id="persondiv" class="detailcontent" style="display:none;">
            <div class="detaildiv">
                <div class="desdiv"><span id="a_detailname">Name</span></div>
                <div class="editdiv"><input id="addname" type="text" style="margin-right:21px;"></div>
            </div>
            <div class="detaildiv detailnumdiv" id="detailnum0div">
                <div class="desdiv"><span id="a_detailnum">Number</span></div>
                <div class="editdiv">
                    <select id="addsipnumtype0" class="acctselect">
                        <option value="2">Mobile</option>
                        <option value="1">Home</option>
                        <option value="3">Work</option>
                        <option value="4">Work Fax</option>
                        <option value="5">Home Fax</option>
                        <option value="6">Pager</option>
                        <option value="7">Other</option>
                        <option value="8">Callback</option>
                        <option value="9">Car</option>
                        <option value="10">Company Main</option>
                        <option value="11">ISDN</option>
                        <option value="12">Main</option>
                        <option value="13">Other Fax</option>
                        <option value="14">Radio</option>
                        <option value="15">Telex</option>
                        <option value="16">TTY TDD</option>
                        <option value="17">Work Mobile</option>
                        <option value="18">Work Pager</option>
                        <option value="19">Assistant</option>
                        <option value="20">MMS</option>
                    </select>
                    <select id="addsipacct0" class="acctselect">
                        <option value="0">SIP</option>
                        <option value="1">IPVideoTalk</option>
                        <option value="8">H.323</option>
                        <!--<option value="2">Account 3</option>
                        <option value="3">Account 4</option>
                        <option value="4">Account 5</option>
                        <option value="5">Account 6</option>-->
                    </select>
                    <input id="addsipnum0" type="text" style="margin-right:21px;" class="numinput">
                </div>
            </div>
            <div class="detaildiv editdiv" id="addnewdiv" style="width:350px;height: 34px;">
                <div class="editdiv" style="float:right;margin-top:-6px;cursor:pointer;"><span id="addnewnumspan">Add New Item</span><button class="addnumicon"></button></div>
            </div>
            <div class="detaildiv detailemaildiv" id="detailemail0div">
                <div class="desdiv"><span id="a_detailemail">Email</span></div>
                <div class="editdiv">
                    <select id="addemailtype0" class="acctselect">
                        <option value="1">Home</option>
                        <option value="2">Work</option>
                        <option value="3">Mobile</option>
                        <option value="4">Other</option>
                    </select>
                    <input id="addemail0" class="emailinput" type="text">
                </div>
            </div>
            <div class="detaildiv editdiv" id="addnewemaildiv" style="width:350px;height: 34px;">
                <div class="editdiv" style="float:right;margin-top:-6px;cursor:pointer;"><span id="addnewemailspan">Add New Item</span><button class="addemailicon"></button></div>
            </div>
            <div class="detaildiv" style="height:auto;">
                <div class="desdiv"><span id="a_detailgroups">Groups</span></div>
                <div class="editdiv" id="addgroups" name="addgroups" style="text-align:left;"></div>
                <div class="editdiv" style="text-align:left;float: right;margin-right: 37px;"><button id="newgroupbtn" name="newgroupbtn">New Group</button></div>
            </div>
        </div>
        <div class="appsbtn" id="rightbtn">
            <button id="savebtn">Save</button>
            <button id="cancelbtn" class="cancelbtn">Cancel</button>
        </div> 
    </div> 
    <div id="newgroupdiv" style="width:100%;height:100%;position:absolute;top:0;left:0;display:none;">
        <div id="newgrouppopdiv">
            <div class="titlediv"><span id="a_newgroup">New Group</span></div>
            <div>
                <div style="margin-top:12px;"><input id="newgroupname" name="newgroupname" type="text" style="width:250px;margin-left:70px;" /></div>
                <div style="margin-top:20px;text-align:center;margin-right:10px;">
                    <button id="addnewgroup">OK</button>
                    <button id="cancelnewgroup" class="cancelbtn">Cancel</button>
                </div>   
            </div>
        </div>
    </div>
    <div id="selectcalldiv">
        <div class="selecttitle"><span></span><button id="closecalldiv"></button></div>
        <div class="selecttips"></div>
        <div id="selectlist">

        </div>
        <div class="selectbtn">
            <button id="selectcall">Call</button><button id="addschedule" class="savebtn">Add</button><button id="selectcancel" class="cancelbtn">Cancel</button>
        </div>
    </div>
</div>
<script type="text/javascript">
	var cookie_lang = $.cookie( "MyLanguage");
    var version = $.cookie("ver");
    if ( !cookie_lang ){
        cookie_lang = 'en';
	}
    if(!version)
        version = new Date().getTime();
    document.write("<script src='../js/public.js?ver=" + version + "'><\/script>");
    document.write("<script src='../lang/" + cookie_lang + ".js?ver=" + version + "'><\/script>");
</script>
<script type="text/javascript" src='../js/apps.js'></script>
<script type="text/javascript">
var itemnum = 0;
var selectid;
var mLogType = 0;
var mDeleteType = 3;
var mDateObj = new Date();
var mEditMode = 0;
var mInit = 0;
var mItemsdivObj, mLogItemsdivObj;
var mRemovenumber = "";
var mOptionNum = 0;
var mOptionNumSuc = 0;
var mOptionNumDone = 0;
var mNumberarray = new Array();
var mAcctarray = new Array();
var mUse24Hour = 1;
var mEditNumberNum = 0;
var mEditEmailNum = 0;
var mInsertBeforeNumObj, mInsertBeforeEmailObj, mDetailParentDivObj;
var mInitGroup = 0;
var mItemData;
var mConfMemberItemData;
var mSingleNameItemData;
var mStartParseIndex = 0;
var mMaxItemIndex = 0;
var mSingleParseNum = 100;
var mIPtest = /^([0-9]|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.([0-9]|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.([0-9]|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.([0-9]|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])$/;
var mMaxlineNum = 1;
var mMaxMember = 1;
var mAcctName = new Array("SIP", "IPVideoTalk", "H.323");
//var mNumberTypes = new Array("Home", "Mobile", "Work", "Work Fax", "Home Fax", "Pager", "Other", "Callback", "Car", "Company Main", "ISDN", "Main", "Other Fax", "Radio", "Telex", "TTY TDD", "Work Mobile", "Work Pager", "Assistant", "MMS");
var mNumberTypes = new Array(a_19087, a_19086, a_19088, a_19089, a_19090, a_19091, a_19092, a_19093, a_19094, a_19095, "ISDN", a_19096, a_19097, a_19098, a_19099, "TTY TDD", a_19100, a_19101, a_19102, a_19103);
//var mEmailTypes = new Array("Home", "Work", "Other", "Mobile");
var mEmailTypes = new Array(a_19129, a_19130, a_19092, a_19086);
var mMaxAccount = 3;
var mOEMID = '0';
var mPromodel = "GVC3200";
var mAcctStatus = new Array();
var mDisdialplan = new Array();

$(function(){
    mPromodel = $("#promodel", window.parent.document).val();
    mMaxlineNum = $("#maxlinenum", window.parent.document).val();
    mMaxMember = mMaxlineNum;
    if( mPromodel == "GVC3202" ){
        mMaxlineNum = 2;
        mMaxMember = 2;
    }
    translate_page();
    var cookie_type = $.cookie( "CalllogType");
    if (cookie_type) {
        mLogType = parseInt(cookie_type);
    }else{
        mLogType = 0;
    }
    mOEMID = $('#existcolore', window.parent.document).val();
    mItemsdivObj = document.getElementById('itemsdiv');
    mLogItemsdivObj = document.getElementById('logitemsdiv');
    mInsertBeforeNumObj = document.getElementById('addnewdiv');
    mInsertBeforeEmailObj = document.getElementById('addnewemaildiv');
    mDetailParentDivObj = document.getElementById('persondiv');
    $("#delcontact").attr("disabled","disabled").addClass("deldisable");
    
    if( mLogType == 1 ){    //incoming
        mDeleteType = 0;
    }else if( mLogType == 2 ){//outgoing
        mDeleteType = 1;
    }else if( mLogType == 3 ){//missed
        mDeleteType = 2;
    }else
        mDeleteType = 3;
    window.parent.block_download_func(a_6660);
    
    //get call history
    if( mOEMID == '54' && mLogType == 0 ){
        get_normal_calllog(0, 0);
    }else{
        get_left_calllog(mLogType);
    }
    cb_get_action('status&region=status');
    cb_get_action("get&var-0000=2382");
    
    var height = parseInt($("#iframediv",parent.document.body).css('height'));
    $("#itemsdiv").css("height", height - 60); //30+18
    $("#logitemsdiv").css("height", height - 50); //14+32+30+18
    $("#persondiv").css("height", height - 100); //14+32+30+18
    $("#savebtn, #cancelbtn").hide();
    pageEventActions();
});

function reget_callhistory(){
    $(".itemdiv, .logitemdiv").remove();
    get_left_calllog(mLogType);
}
function parse_calllog(items){
    var id, type, disname, number, duration, date, iscontact, isconf, isvideo, confid, acctindex;
    for (var i = 0; items[i] != undefined; i++)
    {
        type = items[i].Type;
        id = items[i].Id;
        disname = items[i].ContactName;
        if( disname == undefined || disname == "" )
            disname = items[i].Name;
        number = items[i].Number;
        duration = parseInt(items[i].Duration);
        date = parseInt(items[i].Date);
        isconf = items[i].IsConf;
        iscontact = items[i].IsContact;
        isvideo = items[i].IsVideo;
        confid = items[i].ConfId;
        acctindex = items[i].Account;
        if( acctindex == undefined )
            acctindex = items[i].AcctIndex;
            
        create_calllog_div(id, type, isvideo, disname, number, acctindex, date, iscontact, 1);  
        //create_right_calllog_div(id, disname, number, isconf, confid, type, isvideo, date, duration);
    } 
}
function create_conf_member_div(id, type, isvideo, disname, number, acctid, date, confid, iscontact, duration){
    if( confid == -1 || $(".memberitemdiv[number=\"" + number + "\"][account=" + acctid + "][confid=" + confid + "]").length == 0 )
    //if( $("#memberlog_" + id).length == 0 )
    {
        var memberitemdiv = document.createElement('DIV');
        memberitemdiv.className='rightitemdiv memberitemdiv';
        memberitemdiv.id = "memberlog_" + id;
        memberitemdiv.setAttribute("confid", confid);
        memberitemdiv.setAttribute("name", disname);
        memberitemdiv.setAttribute("disname", disname);
        memberitemdiv.setAttribute("number", number);
        memberitemdiv.setAttribute("account", acctid);
        memberitemdiv.setAttribute("duration", duration);
        memberitemdiv.setAttribute("type", type);
        if( confid == -1 )
            memberitemdiv.setAttribute("confmember", "0");
        else
            memberitemdiv.setAttribute("confmember", "1");
        memberitemdiv.setAttribute("logid", id);
        memberitemdiv.setAttribute("iscontact", iscontact);
        
        /*var memberarrowdiv = document.createElement('DIV');
        memberarrowdiv.className='itemarrow';
        memberitemdiv.appendChild(memberarrowdiv);*/
        
        var membericondiv = document.createElement('DIV');
        membericondiv.className='itemicon';
        var membericon = document.createElement('DIV');
        if( type == "3" )
            membericon.className='appmissedicon';
        else if( type == "1" )
            membericon.className='appincomingicon';
        else  
            membericon.className='appcallouticon';
        membericondiv.appendChild(membericon);
        memberitemdiv.appendChild(membericondiv);
        
        var membernamediv = document.createElement('DIV');
        membernamediv.className='itemname';
        var videoicondiv = document.createElement('DIV');
        videoicondiv.className='itemmembericon';
        var videoicon = document.createElement('DIV');
        if( isvideo == "1" ){
            videoicon.className='videoicon';
            memberitemdiv.setAttribute("isvideo", 1);
        }
        else{
            videoicon.className='audioicon';
            memberitemdiv.setAttribute("isvideo", 0);
        }
        videoicondiv.appendChild(videoicon);
        membernamediv.appendChild(videoicondiv);

        /*var membernametext = document.createElement('SPAN');
        membernametext.innerHTML = htmlEncode(disname);
        membernametext.className = "membernamespan";
        membernametext.setAttribute("title", disname);
        membernamediv.appendChild(membernametext);*/
        
        var namedivdiv = document.createElement('DIV');
        namedivdiv.className='namedividerdiv';
        var nametopdiv = document.createElement('DIV');
        nametopdiv.className='itemnametopchild';
        var spantext = document.createElement('SPAN');
        spantext.innerHTML = htmlEncode(disname);
        spantext.setAttribute("title", disname);
        nametopdiv.appendChild(spantext);
        var namebotdiv = document.createElement('DIV');
        namebotdiv.className='itemnamebotchild';
        var spantext2 = document.createElement('SPAN');
        spantext2.innerHTML = htmlEncode(number);
        spantext2.setAttribute("title", number);
        namebotdiv.appendChild(spantext2);
        namedivdiv.appendChild(nametopdiv);
        namedivdiv.appendChild(namebotdiv);
        membernamediv.appendChild(namedivdiv);    
        memberitemdiv.appendChild(membernamediv);    

        var membernumberdiv = document.createElement('DIV');
        membernumberdiv.className='itemnumber';
        
        var numbertopdiv = document.createElement('DIV');
        numbertopdiv.className='itemnumbertop';
        var membertimetext = document.createElement('SPAN');
        membertimetext.innerHTML = htmlEncode(convertTime(date));
        numbertopdiv.appendChild(membertimetext);
        membernumberdiv.appendChild(numbertopdiv);
        
        if(acctid != 1 || duration != 0){
            var numberbotdiv = document.createElement('DIV');
            numberbotdiv.className='itemnumbertop';
            var membernumbertext = document.createElement('SPAN');
            if(type == 3)
                membernumbertext.innerHTML = a_16401;
            else
                membernumbertext.innerHTML = htmlEncode(convertDuration2(duration));
            numberbotdiv.appendChild(membernumbertext);
            membernumberdiv.appendChild(numberbotdiv);
        }

        memberitemdiv.appendChild(membernumberdiv);
        mLogItemsdivObj.appendChild(memberitemdiv);
        
        //if( $('#conflog_'+confid).length > 0 )
            //$('#conflog_'+confid).after( $("#memberlog_"+id) );  
    }
}
function convertDuration2(duration){
    if( duration == 0 )
        return "0" + a_15005;
    var day = parseInt(duration / (24 * 3600));
    duration %= (24 * 3600);
    var hour = parseInt(duration / 3600);
    if( day > 0 )
        hour += day * 24;
    duration %= 3600;
    var min = parseInt(duration / 60);
    var sec = parseInt(duration % 60);
    var timestr = "";
    /*if( day > 0 ){
        timestr += day + " ";
        if( day > 1 )
            timestr += a_days;
        else
            timestr += a_day;
        timestr += " ";
    }*/
    if( hour > 0 ){
        /*timestr += hour + a_15010 + " ";
        if( min < 10 )
            timestr += "0";
        timestr += min + a_15011 + " ";
        if( sec < 10 )
            timestr += "0";
        timestr += sec + a_15005;*/
        timestr += hour + a_15010 + " " + min + a_15011 + " " + sec + a_15005;
    }else if( min > 0 ){
        /*if( min < 10 )
            timestr += "0";
        timestr += min + a_15011 + " ";
        if( sec < 10 )
            timestr += "0";
        timestr += sec + a_15005;*/
        timestr += min + a_15011 + " " + sec + a_15005;
    }else{
        /*if( sec < 10 )
            timestr += "0";*/
        timestr += sec + a_15005;
    } 
    
    return timestr;
    
}
function create_calllog_div(id, type, isvideo, disname, number, acctindex, date, iscontact, show){
    //if( $(".itemdiv[number=\"" + number + "\"][confid=0]").length == 0 )
    if( $(".normalitemdiv[number=\"" + number + "\"][account=" + acctindex + "]").length == 0 )
    //if( $("#calllog_" + id).length == 0 )
    {
        var itemdiv = document.createElement('DIV');
        itemdiv.className='itemdiv normalitemdiv';
        itemdiv.id = "calllog_" + id;
        itemdiv.setAttribute("name", disname);
        itemdiv.setAttribute("disname", disname);
        itemdiv.setAttribute("number", number);
        itemdiv.setAttribute("account", acctindex);
        itemdiv.setAttribute("confmember", "0");
        itemdiv.setAttribute("confid", "0");
        itemdiv.setAttribute("logid", id);
        itemdiv.setAttribute("iscontact", iscontact);
        itemdiv.setAttribute("loaded", "0");
        itemdiv.setAttribute("lognum", "1");
        itemdiv.setAttribute("mtype", type);
        if( show == 0 ){
            itemdiv.style.display = "none";
        }
        /*var arrowdiv = document.createElement('DIV');
        arrowdiv.className='itemarrow';
        arrowdiv.style.display = "none";
        itemdiv.appendChild(arrowdiv);*/
        var checkdiv = document.createElement('DIV');
        checkdiv.className='itemcheck';
        var checkbox = document.createElement('INPUT');
        checkbox.type = 'checkbox';
        checkbox.className = "inputcbx";
        checkdiv.appendChild(checkbox);
        itemdiv.appendChild(checkdiv);
        
        var icondiv = document.createElement('DIV');
        icondiv.className='itemicon';
        var itemicon = document.createElement('DIV');
        if( type == "3" )
            itemicon.className='appmissedicon';
        else if( type == "1" )
            itemicon.className='appincomingicon';
        else  
            itemicon.className='appcallouticon';
        icondiv.appendChild(itemicon);
        itemdiv.appendChild(icondiv);

        var namediv = document.createElement('DIV');
        namediv.className='itemname';
        /*var videoicondiv = document.createElement('DIV');
        videoicondiv.className='itemmembericon';
        var videoicon = document.createElement('DIV');
        if( isvideo == "1" )
            videoicon.className='videoicon';
        else  
            videoicon.className='audioicon';
        videoicondiv.appendChild(videoicon);
        namediv.appendChild(videoicondiv);*/	
        /*var nametopdiv = document.createElement('DIV');
        nametopdiv.className='itemnametopchild';
        var spantext = document.createElement('SPAN');
        spantext.innerHTML = htmlEncode(disname);
        nametopdiv.appendChild(spantext);
        var namebotdiv = document.createElement('DIV');
        namebotdiv.className='itemnamebotchild';
        var spantext2 = document.createElement('SPAN');
        spantext2.innerHTML = htmlEncode(number);
        namebotdiv.appendChild(spantext2);
        namediv.appendChild(nametopdiv);
        namediv.appendChild(namebotdiv);
        itemdiv.appendChild(namediv);  */                              
        
        var spantext = document.createElement('SPAN');
        spantext.innerHTML = htmlEncode(disname);
        spantext.setAttribute("title", disname);
        namediv.appendChild(spantext);
        itemdiv.appendChild(namediv);                                
        
        var datediv = document.createElement('DIV');
        datediv.className='itemnumber';
        //datediv.style.marginLeft = '43px';
        /*var datetext = document.createElement('SPAN');
        datetext.innerHTML = htmlEncode(convertTime(date));
        datediv.appendChild(datetext);
        itemdiv.appendChild(datediv);*/
        
        var datestr = convertTime(date).split(" ");
        var datetopdiv = document.createElement('DIV');
        datetopdiv.className='itemdatechild';
        var datetoptext = document.createElement('SPAN');
        if( mUse24Hour == 1 )
            datetoptext.innerHTML = htmlEncode(datestr[1]);
        else
            datetoptext.innerHTML = htmlEncode(datestr[1] + " " + datestr[2]);
        datetopdiv.appendChild(datetoptext);
        var datebotdiv = document.createElement('DIV');
        datebotdiv.className='itemdatechild';
        var datebottext = document.createElement('SPAN');
        datebottext.innerHTML = htmlEncode(datestr[0]);
        datebotdiv.appendChild(datebottext);
        datediv.appendChild(datetopdiv);
        datediv.appendChild(datebotdiv);
        itemdiv.appendChild(datediv);  
	
        mItemsdivObj.appendChild(itemdiv);
        
        //create_conf_member_div(id, type, isvideo, disname, number, 0, date, -1, iscontact);
    }else{
        if( ( type == "3" || mOEMID == "54" ) && $(".normalitemdiv[number=\"" + number + "\"][account=" + acctindex + "]").attr("loaded") == "0" ){
            var lognum = $(".normalitemdiv[number=\"" + number + "\"][account=" + acctindex + "]").attr("lognum");
            lognum ++;
            $(".normalitemdiv[number=\"" + number + "\"][account=" + acctindex + "]").attr("lognum", lognum).children(".itemname").children("span").html( htmlEncode($(".normalitemdiv[number=\"" + number + "\"][account=" + acctindex + "]").attr("disname")) + "<span class='missednum'>("+ lognum +")</span>" );
        }
    }
}

function create_single_conf_item(id, disname, duration, date, isschedule, show){
    var nameattr = disname.replace(/\"/g,"'");  //change " to '
    //if( $(".confitemdiv[name=\"" + nameattr + "\"]").length == 0 )
    if( $("#conflog_" + id ).length == 0 )
    {
        var itemdiv = document.createElement('DIV');
        itemdiv.className='itemdiv confitemdiv';
        itemdiv.id = "conflog_" + id;
        itemdiv.setAttribute("name", nameattr);
        if( isschedule == "1" )
            itemdiv.setAttribute("disname", nameattr); 
        else
            itemdiv.setAttribute("disname", "");    //will replace to member names
        itemdiv.setAttribute("isconf", "1");
        itemdiv.setAttribute("confid", id);
        itemdiv.setAttribute("isschedule", isschedule);
        itemdiv.setAttribute("justload", "1");
        itemdiv.setAttribute("loaded", "0");
        itemdiv.setAttribute("mloaded", "0");
        itemdiv.setAttribute("mids", "");
        itemdiv.setAttribute("mnames", "");
        itemdiv.setAttribute("number", "");
        itemdiv.setAttribute("account", "");
        itemdiv.setAttribute("mdurations", "");
        itemdiv.setAttribute("mdates", "");
        itemdiv.setAttribute("misvideo", "");
        itemdiv.setAttribute("miscontact", "");
        itemdiv.setAttribute("mtype", "");
        if( show == 0 ){
            itemdiv.style.display = "none";
        }
        /*var arrowdiv = document.createElement('DIV');
        arrowdiv.className='itemarrow';
        arrowdiv.setAttribute("isopen", "0");
        var itemarrow = document.createElement('DIV');
        itemarrow.className='rightarrowicon';
        arrowdiv.appendChild(itemarrow);
        itemdiv.appendChild(arrowdiv);*/
        var checkdiv = document.createElement('DIV');
        checkdiv.className='itemcheck';
        var checkbox = document.createElement('INPUT');
        checkbox.type = 'checkbox';
        checkbox.className = "inputcbx";
        checkdiv.appendChild(checkbox);
        itemdiv.appendChild(checkdiv);
        
        var icondiv = document.createElement('DIV');
        icondiv.className='itemicon';
        var itemicon = document.createElement('DIV');
        itemicon.className='appconficon';
        icondiv.appendChild(itemicon);
        itemdiv.appendChild(icondiv);
        
        var namediv = document.createElement('DIV');
        namediv.className='itemname';
        var spantext = document.createElement('SPAN');
        spantext.innerHTML = htmlEncode(disname);
        spantext.setAttribute("title", disname);
        namediv.appendChild(spantext);
        itemdiv.appendChild(namediv);	                                
        
        var datediv = document.createElement('DIV');
        datediv.className='itemnumber';
        /*var datetext = document.createElement('SPAN');
        datetext.innerHTML = htmlEncode(convertTime(date));
        datediv.appendChild(datetext);
        itemdiv.appendChild(datediv);*/
        var datestr = convertTime(date).split(" ");
        var datetopdiv = document.createElement('DIV');
        datetopdiv.className='itemdatechild';
        var datetoptext = document.createElement('SPAN');
        if( mUse24Hour == 1 )
            datetoptext.innerHTML = htmlEncode(datestr[1]);
        else
            datetoptext.innerHTML = htmlEncode(datestr[1] + " " + datestr[2]);
        datetopdiv.appendChild(datetoptext);
        var datebotdiv = document.createElement('DIV');
        datebotdiv.className='itemdatechild';
        var datebottext = document.createElement('SPAN');
        datebottext.innerHTML = htmlEncode(datestr[0]);
        datebotdiv.appendChild(datebottext);
        datediv.appendChild(datetopdiv);
        datediv.appendChild(datebotdiv);
        itemdiv.appendChild(datediv);  
        
        mItemsdivObj.appendChild(itemdiv);
    }
}
function parse_all_single_log(items){
    var id, confid, type, disname, contactname, number, duration, date, acctid, isconf, isvideo, iscontact, confname;
    var lognum = 0;
    for (var i = 0; items[i] != undefined; i++)
    {
        id = items[i].Id;
        type = items[i].Type;
        disname = items[i].Name;
        number = items[i].Number;
        duration = parseInt(items[i].Duration);
        date = parseInt(items[i].Date);
        acctid = items[i].AcctIndex;
        isconf = items[i].IsConf;
        contactname = items[i].ContactName;
        isvideo = items[i].IsVideo;
        confid = items[i].ConfId;
        iscontact = items[i].IsContact;
        confname = items[i].Confname;
        if( contactname != "" )
            disname = contactname;

        create_conf_member_div(id, type, isvideo, disname, number, acctid, date, -1, iscontact, duration);
        if( type == "3" || mOEMID == "54" )
            lognum ++;
        //create_right_calllog_div(id, disname, number, isconf, confid, type, isvideo, date, duration, confname); 
    }
    if( $(".normalitemdiv[number=\""+number+"\"][account=" + acctid + "]").attr("lognum") != lognum){
        $(".normalitemdiv[number=\""+number+"\"][account=" + acctid + "]").attr("lognum", lognum).children(".itemname").children("span").html(htmlEncode(disname)+"<span class='missednum'>("+lognum+")</span>");
    }
}
function add_item_event(){
    $(".itemdiv").unbind(); //to avoid too many click callback by one click
    $(".itemdiv").click(function(){
        if( mEditMode != 0 ) {
            $("#cancelbtn").click();
        }
        var confid = $(this).attr("confid");
        var disnumber = $(this).attr("number");
        var acctid = $(this).attr("account");
        var confname = $(this).attr("name");
        var reloadevent = 0;
        $(".memberitemdiv").hide();
        //var loaded = $(this).attr("loaded");
        //if( loaded == "0" ){
            if( $(this).attr("isconf") == "1" ){
                /*$(this).attr("loaded", "1");
                get_callconf_by_name(confname);
                reloadevent = 1;*/
                var mloaded = $(this).attr("mloaded");
                if( mloaded == "0" ){
                    if( $(this).attr("isconf") == "1" ){
                        var membernumbers = $(this).attr("number");
                        var memberaccts = $(this).attr("account");
                        var membernames = $(this).attr("mnames");
                        var dismembernames = membernames.replace(/\:::/g,",");
                        $(".logitemmembers[isconf=1][name=\""+confname+"\"]").attr("title", dismembernames).text(dismembernames);
                        var mids = $(this).attr("mids");
                        if( mids.indexOf(":::") != "-1" ){
                            var tmids = mids.split(":::");
                            var tnumber = membernumbers.split(":::");
                            var tacct = memberaccts.split(":::");
                            var tname = membernames.split(":::");
                            var ttype = $(this).attr("mtype").split(":::");
                            var tisvideo = $(this).attr("misvideo").split(":::");
                            var tiscontact = $(this).attr("miscontact").split(":::");
                            var tdurations = $(this).attr("mdurations").split(":::");
                            var tdate = $(this).attr("mdates").split(":::");
                            for( var i = 0; i < tmids.length; i++ ){
                                create_conf_member_div(tmids[i], ttype[i], tisvideo[i], tname[i], tnumber[i], tacct[i], tdate[i], confid, tiscontact[i], tdurations[i]);  
                            }              
                        }else{
                            create_conf_member_div(mids, $(this).attr("mtype"), $(this).attr("misvideo"), membernames, membernumbers, memberaccts, $(this).attr("mdates"), confid, $(this).attr("miscontact"), $(this).attr("mdurations"));
                        }
                        $(this).attr("mloaded", "1");
                        reloadevent = 1;
                    }
                }
            }else{
                if( $(this).attr("loaded") == 0 ){
                    get_calllog_by_number(disnumber, acctid, mLogType);
                    $(this).attr("loaded", "1");
                    reloadevent = 1;
                }
                
                if(mOEMID != "54"){
                    var curtype = $(this).attr("mtype");
                    $(".memberitemdiv[number=\""+disnumber+"\"][account=" + acctid + "][type=" + curtype + "]").show();
                }
                else{
                    $(".memberitemdiv[number=\""+disnumber+"\"][account=" + acctid + "]").show();
                }
                    
                //$("#memberlog_" + $(this).attr("logid")).show();
                
                //$(".memberitemdiv[number=\""+disnumber+"\"]").attr("loaded", "1");
                //$(".normalitemdiv[number=\""+disnumber+"\"][account=" + acctid + "]").attr("loaded", "1");
                
            }
        //}
        
        if( reloadevent ){
            add_item_event();
        }
        $("#"+selectid).removeClass("selectItem");
        selectid = $(this).attr("id");
        var nameattr = $(this).attr("name");
        $("#a_detailstitle").attr("title",$(this).attr("disname")).text($(this).attr("disname"));
        $(".logitemdiv").hide();
        $("#logitemsdiv").show();
        $(this).addClass("selectItem"); //.siblings(".itemdiv").removeClass("selectItem");

        if( $(this).attr("isconf") == "1" ){
            $(".memberitemdiv[confid=\""+ confid +"\"]").each(function(){
                if($(this).children(".itemnumber").children(".itemnumbertop").length < 2){
                    $(this).children(".itemnumber").children(".itemnumbertop").css("margin-top", "10px");
                }
            });
            $(".memberitemdiv[confid=" + confid + "]").show();
        }else{
            $(".logitemdiv[number=\"" + disnumber + "\"][account=" + acctid + "]").show();
        }
        /*if( $(this).attr("iscontact") == "0" ){
            $("#addtocontact").show();
        }else{
            $("#addtocontact").hide();
        }*/
        $("#cancelbtn").hide();
        //$("#editbtn").show();
        //return false;
    }); 

    $(".itemdiv").hover(function(){
        $(this).addClass("hoverItem");
        $(this).children(".itemnumber").hide();
        if( $(this).attr("iscontact") == "0" ){
            if( $(this).attr("number") == "anonymous" )
                $("#addtocontact").hide();
            else
                $("#addtocontact").show();
        }else{
            $("#addtocontact").hide();
        }
        if( mOEMID == "54" ){
            $("#addtoschedule").hide();
        }else{
            $("#addtoschedule").show();
        }
        /*if( $(this).attr("number") == "anonymous" ){
            $("#addtoschedule").hide();
        }else{
            $("#addtoschedule").show();
        }*/
        $("#divcallbtn").appendTo($(this)).show();
    },function(){
        //if( selectid != $(this).attr("id") )
            $(this).removeClass("hoverItem");
        $(this).children(".itemnumber").show();
        $("#divcallbtn").hide();
    });
    
    $(".rightitemdiv").hover(function(){
        $(this).addClass("hoverItem");
        $(this).children(".itemnumber").hide();
        $("#rightdivcallbtn").appendTo($(this)).show();
        $(this).children(".itemname").children(".namedividerdiv").children(".itemnamebotchild").show();
        if( $(this).attr("iscontact") == "0" ){
            if( $(this).attr("number") == "anonymous" || $(this).attr("account") == "2" )
                $("#rightaddtocontact").hide();
            else
                $("#rightaddtocontact").show();
        }else{
            $("#rightaddtocontact").hide();
        }
    },function(){
        $(this).removeClass("hoverItem");
        $(this).children(".itemnumber").show();
        $(this).children(".itemname").children(".namedividerdiv").children(".itemnamebotchild").hide();
        $("#rightdivcallbtn").hide();
    });
}

function add_selectlist_event()
{
    $("#selectlist input").click(function(){
        var num_member = 0;
        if($(this).prop("checked") == true)
        {
            $("#selectlist input").each(function(){
                if($(this).prop("checked") == true)
                {
                    num_member++;
                }
            });

            if(num_member > mMaxlineNum)
            {
                $(".selecttips").text(a_10097);
                setTimeout(function(){
                    $(".selecttips").text("");
                },2000);
                return false;
            }
        }
    });
}

function init_page_event(init){
    add_item_event();
    /*$(".itemarrow").unbind();
    $(".itemarrow").click(function(){
        var confid = $(this).parent(".itemdiv").attr("confid");
        if( $(this).attr("isopen") == "0" ){
            var mloaded = $(this).parent(".itemdiv").attr("mloaded");
            if( mloaded == "0" ){
                if( $(this).parent(".itemdiv").attr("isconf") == "1" ){
                    var membernumbers = $(this).parent(".itemdiv").attr("number");
                    var membernames = $(this).parent(".itemdiv").attr("mnames");
                    var dismembernames = membernames.replace(/\:::/g,",");
                    var confname = $(this).parent(".itemdiv").attr("name");
                    $(".logitemmembers[isconf=1][name=\""+confname+"\"]").attr("title", dismembernames).text(dismembernames);
                    var mids = $(this).parent(".itemdiv").attr("mids");
                    if( mids.indexOf(":::") != "-1" ){
                        var tmids = mids.split(":::");
                        var tnumber = membernumbers.split(":::");
                        var tname = membernames.split(":::");
                        var ttype = $(this).parent(".itemdiv").attr("mtype").split(":::");
                        var tisvideo = $(this).parent(".itemdiv").attr("misvideo").split(":::");
                        var tiscontact = $(this).parent(".itemdiv").attr("miscontact").split(":::");
                        var tdate = $(this).parent(".itemdiv").attr("mdates").split(":::");
                        for( var i = 0; i < tmids.length; i++ ){
                            create_conf_member_div(tmids[i], ttype[i], tisvideo[i], tname[i], tnumber[i], 0, tdate[i], confid, tiscontact[i]);  
                        }              
                    }else{
                        create_conf_member_div(mids, $(this).parent(".itemdiv").attr("mtype"), $(this).parent(".itemdiv").attr("misvideo"), membernames, membernumbers, 0, $(this).parent(".itemdiv").attr("mdates"), confid, $(this).parent(".itemdiv").attr("miscontact"));
                    }
                    $(this).parent(".itemdiv").attr("mloaded", "1");
                    add_item_event();
                }
            }
        
            $(this).attr("isopen", "1");
            $(this).children("div").removeClass("rightarrowicon").addClass("downarrowicon");
            $(".memberitemdiv[confid=\"" + confid + "\"]").show();
        }else{
            $(this).attr("isopen", "0");
            $(this).children("div").removeClass("downarrowicon").addClass("rightarrowicon");
            $(".memberitemdiv[confid=\"" + confid + "\"]").hide();
        }
        //return false;
    });*/

    if( init == 1 ){
        $(".itemdiv").show();
        if( $(".itemdiv:visible").length > 0 ){
            $("#delcontact").show();
            $(".itemdiv:visible").eq(0).click();   
        }else{
            create_nocall_div();
        }
    }
    window.parent.unblock_func();
}
function create_nocall_div(){
    if( $("#nocalldiv").length > 0 ){
        $("#nocalldiv").show();
    }else{
        var nocalldiv = document.createElement('DIV');
        nocalldiv.className='nocalldiv';
        nocalldiv.id='nocalldiv';
        var itemsheight = $("#itemsdiv").css("height");
        nocalldiv.style.lineHeight = itemsheight;
        var nocalltext = document.createElement('SPAN');
        nocalltext.innerHTML = htmlEncode(a_15014);
        nocalldiv.appendChild(nocalltext);
        mItemsdivObj.appendChild(nocalldiv);
    }
    $("#a_detailstitle").text("");
    $("#loadmorediv, #addtocontact, #selectall, #delcontact, #cancelbtn, #divcallbtn, #rightdivcallbtn").hide();
    window.parent.unblock_func();
}
function parse_calllog_name(items){
    var id, disname, iscontact;
    var groupsdiv = document.getElementById('addgroups');
    for (var i = 0; items[i] != undefined; i++)
    {
        id = items[i].Id;
        if( $("#calllog_" + id).length > 0 )
        {
            disname = items[i].Name;
            iscontact = items[i].IsContact;
            $("#calllog_" + id).attr("iscontact", iscontact);
            //$("#memberlog_" + id).attr("iscontact", iscontact);
            if( disname != "" ){
                var spantext = disname;
                $("#calllog_" + id).attr("disname", disname).children(".itemname").children("span").attr("title", disname);
                if(disname.length>15){
                    disname = disname.substring(0,15) + "...";
                }
                if( $("#calllog_" + id).attr("lognum") != "1" ){
                    spantext = htmlEncode(disname) + "<span class='missednum'>("+ $("#calllog_" + id).attr("lognum") +")</span>";
                }       
                $("#calllog_" + id).children(".itemname").children("span").html(spantext);        
            }
        } 
    }
}
function parse_groups(items){
    var id, disname;
    var groupsdiv = document.getElementById('addgroups');
    for (var i = 0; items[i] != undefined; i++)
    {
        id = items[i].Id;
        disname = items[i].Name;
        
        if( $("#addgroup_" + id).length == 0 )
        {
            var checkbox = document.createElement('INPUT');
            checkbox.type = 'checkbox';
            checkbox.className = "inputcbx";
            checkbox.id = "addgroup_" + id;
            checkbox.setAttribute("groupid", id);
            checkbox.setAttribute("groupname", disname);
            var spantext = document.createElement('SPAN');
            spantext.innerHTML = htmlEncode(disname);
            spantext.setAttribute("title", disname);
            groupsdiv.appendChild(checkbox);
            groupsdiv.appendChild(spantext);
            var brbox = document.createElement('BR');
            groupsdiv.appendChild(brbox);
        } 
    }
}
function parse_conf_members(items){
    var logid, confid, type, disname, contactname, number, duration, date, acctid, isconf, isvideo, iscontact, acctindex;
    var tmpnames, tmpnumbers, tmpduration, tmpdate, tmpiscontact, tmpdisname, checknumber;
    for (var i = 0; items[i] != undefined; i++)
    {
        confid = items[i].Id;
        if( $("#conflog_"+confid).length <= 0 )
            continue;
        if( $("#conflog_"+confid).attr("justload") != "1" )
            continue;
        logid = items[i].LogId;
        disname = items[i].Name;
        number = items[i].Number;
        duration = parseInt(items[i].Duration);
        date = parseInt(items[i].Date);
        type = items[i].Type;
        isvideo = items[i].IsVideo;
        iscontact = items[i].IsContact;
        acctindex = items[i].Account;
        
        tmpnumbers = $("#conflog_"+confid).attr("number");
        checknumber = ":::" + tmpnumbers + ":::";
        if( checknumber.indexOf(":::"+number+":::") != -1 )
            continue;
        tmpdisname = $("#conflog_"+confid).attr("disname");
        tmpid = $("#conflog_"+confid).attr("mids");
        tmpnames = $("#conflog_"+confid).attr("mnames");
        tmpduration = $("#conflog_"+confid).attr("mdurations");
        tmpdate = $("#conflog_"+confid).attr("mdates");
        tmptype = $("#conflog_"+confid).attr("mtype");
        tmpisvideo = $("#conflog_"+confid).attr("misvideo");
        tmpiscontact = $("#conflog_"+confid).attr("miscontact");
        tmpaccts = $("#conflog_"+confid).attr("account");
        if( tmpnumbers != "" ){
            tmpdisname += ",";
            tmpid += ":::";
            tmpnames += ":::";
            tmpnumbers += ":::";
            tmpaccts += ":::";
            tmpduration += ":::";
            tmpdate += ":::";
            tmptype += ":::";
            tmpisvideo += ":::";
            tmpiscontact += ":::";
        }
        tmpdisname += disname;
        tmpid += logid;
        tmpnames += disname;
        tmpnumbers += number;
        tmpduration += duration;
        tmpdate += date;
        tmptype += type;
        tmpisvideo += isvideo;
        tmpiscontact += iscontact;
        tmpaccts += acctindex;
        $("#conflog_"+confid).attr("mids", tmpid).attr("mnames", tmpnames).attr("number", tmpnumbers).attr("account", tmpaccts).attr("mdurations", tmpduration).attr("mdates", tmpdate).attr("mtype", tmptype).attr("misvideo", tmpisvideo).attr("miscontact", tmpiscontact);
        //if not schedule
        if( $("#conflog_"+confid).attr("isschedule") != "1" )
            $("#conflog_"+confid).attr("disname", tmpdisname).children(".itemname").children("span").attr("title", tmpdisname).text(tmpdisname);
        //create_conf_member_div(logid, type, isvideo, disname, number, 0, date, confid, iscontact);
        /*if( mInit == 0 )
            $("#memberlog_"+logid).show();
        $("#conflog_"+confid).attr("loaded", "1");*/
    }
    var isInCall = $("#busylinenum",window.parent.document).val();
    $(".itemdiv[isconf=1][justload=1]").each(function(){
        var membernumbers = $(this).attr("number");
        if( membernumbers == "" ){
            $(this).remove(); 
            if( (mLogType == "0" || mLogType == "4") && isInCall == "0" )
                cb_get_action_nocallback("removecallconf&region=webservice&confId=" + $(this).attr("confid")) 
        }
        $(this).attr("justload", "0"); 
        /*else{
            var membernames = $(this).attr("mnames");
            var confname = $(this).attr("name");
            $(".logitemmembers[isconf=1][confid=\""+confid+"\"]").attr("title", membernames).text(membernames);
            $(".logitemdate[isconf=1][confid="+confid+"]").children("span").attr("title", confname).text(confname);
        }*/
        /*if( $(this).attr("isconf") == "1" ){
            var confname = $(this).attr("name");
            var membernames = "";
            var membernumbers = "";
            var memberaccts = "";
            var confid;
            $(".logitemdiv[isconf=1][name=\"" + confname + "\"]").each(function(){
                confid = $(this).attr("logid");
                membernames = "";
                membernumbers = "";
                memberaccts = "";
                $(".memberitemdiv[confid="+confid+"]").each(function(){
                    if( membernames != "" ){
                        membernames += ",";
                    }
                    membernames += $(this).attr("name");
                    if( $(this).attr("number") != "anonymous" ){
                        if( membernumbers != "" ){
                            membernumbers += ",";
                            memberaccts += ",";
                        }
                        membernumbers += $(this).attr("number");
                        memberaccts += $(this).attr("account");
                    }
                });
                $(".logitemmembers[isconf=1][confid=\""+confid+"\"]").attr("title", membernames).text(membernames);
                $(".logitemdate[isconf=1][confid="+confid+"]").children("span").attr("title", confname).text(confname);
                if( $("#conflog_"+confid).length > 0 ){
                    if( membernumbers == "" ){
                        $("#conflog_"+confid).remove();
                        if( mLogType == "0" || mLogType == "4" )
                            cb_get_action_nocallback("removecallconf&region=webservice&confId=" + confid);
                    }else{
                        $("#conflog_"+confid).attr("number", membernumbers).attr("account", memberaccts);
                    }
                }
            }); */  
        //}
    });
}

function parse_left_items_by_time(show){
    var endnum = mStartParseIndex + mSingleParseNum;
    if( mMaxItemIndex < endnum )
        endnum = mMaxItemIndex;
    var hasconf = 0, hassingle = 0;
    var id, confid, type, nameornumber, number, duration, date, acctid, isconf, isvideoorschedule, iscontact, acctindex;
    for (var i = mStartParseIndex; i < endnum; i++)
    {
        id = mItemData[i].Id;
        nameornumber = mItemData[i].NameOrNumber;
        duration = parseInt(mItemData[i].Duration);
        date = parseInt(mItemData[i].Date);
        type = mItemData[i].Type;
        isvideoorschedule = mItemData[i].IsVideo;
        isconf = mItemData[i].IsConf;
        acctindex = mItemData[i].Account;
        
        if( isconf == "1" ){
            hasconf = 1;
            create_single_conf_item(id, nameornumber, duration, date, isvideoorschedule, show);
        }else{
            hassingle = 1;
            create_calllog_div(id, type, isvideoorschedule, nameornumber, nameornumber, acctindex, date, "2", show);
        }
    }
    if( mStartParseIndex != 0 ){
        if( hasconf )
            parse_conf_members(mConfMemberItemData);
        if( hassingle )
            parse_calllog_name(mSingleNameItemData);
    }    
    init_page_event(0);
    if( mMaxItemIndex <= endnum ){
        $("#loadmorediv").remove();
    }else{
        mStartParseIndex = endnum;
        $("#loadmorediv").appendTo($("#itemsdiv")).show(); 
    }
}
function cb_get_action_done(data, action) {
    if( data.substring(0, 1) == "{" )
    {
        if( action.indexOf("sqlitecontacts" ) != "-1" || action.indexOf("sqliteconf" ) != "-1" ){
            var tObj = eval("(" + data + ")");
            var items = tObj.Data;
            if( action.indexOf("type=leftcalllogall") != "-1" ){
                mUse24Hour = tObj.Use24Hour;
                mItemData = items;
                mStartParseIndex = 0;
                mMaxItemIndex = mItemData.length;
                parse_left_items_by_time(0);
                get_all_conf_member();
            }else if( action.indexOf("type=leftcalllogtype") != "-1" || action.indexOf("type=calllog&flag=0") != "-1"){
                mUse24Hour = tObj.Use24Hour;
                parse_calllog(items);
                mInit = 1;
            }else if( action.indexOf("type=confmember") != "-1" ){
                if( action.indexOf("flag=1") != "-1" ){
                    mConfMemberItemData = items;
                    parse_conf_members(mConfMemberItemData);
                    get_normal_calllog_names();
                }else{
                    parse_conf_members(items);
                }
            }else if( action.indexOf("type=leftcalllogname") != "-1" ){
                mSingleNameItemData = items;
                parse_calllog_name(items);
                mInit = 1;
            }else if( action.indexOf("type=calllog&flag=1") != "-1" ){
                parse_all_single_log(items);
                //mInit = 0; 
            }else if( action.indexOf("type=groups") != "-1" ){
                parse_groups(items); 
                mInit = 0;              
            }
            if( mInit == 1 )
            {
                mInit = 0;  //could not move to after init_page_event,or else will have a while circle for the first item click event
                init_page_event(1);
            }
        }else if(action.indexOf("setcontact") != -1 ){
            var tObj = eval("(" + data + ")");              
            if( tObj.res == "success" ){//success
                var newname = $("#addname").val();
                var newnumber = $("#addsipnum0").val();
                var newacct = $("#addsipacct0").val();
                $(".normalitemdiv[iscontact=0][number=\""+newnumber+"\"][account=" + newacct + "]").each(function(){
                    $(this).attr("name", newname).attr("disname", newname).attr("iscontact", "1");
                    $(this).children(".itemname").children("span").attr("title", newname).text(newname);
                });
                var tmpnumber, tmpname, numberstr;
                $(".confitemdiv").each(function(){
                    tmpnumber = ":::" + $(this).attr("number") + ":::";
                    numberstr = ":::"+newnumber+":::";
                    if( tmpnumber.indexOf(numberstr) != -1 ){
                        tmpname = ":::" + $(this).attr("mnames") + ":::";
                        tmpname = tmpname.replace(numberstr, ":::"+newname+":::");
                        tmpname = tmpname.substring(2, tmpname.length-3);
                        $(this).attr("mnames", tmpname);
                        tmpname = tmpname.replace(/:::/g, ",");
                        $(this).attr("disname", tmpname);
                        $(this).children(".itemname").children("span").attr("title", tmpname).text(tmpname);
                    }
                });
                $(".rightitemdiv[iscontact!=1][number=\""+newnumber+"\"][account=" + newacct + "]").each(function(){
                    $(this).attr("name", newname).attr("disname", newname).attr("iscontact", "1");
                    $(this).children(".itemname").children(".namedividerdiv").children(".itemnametopchild").children("span").attr("title", newname).text(newname);
                });
                $("#persondiv, #savebtn, #cancelbtn").hide(); 
                mEditMode = 0;
                $("#"+selectid).click();
            }else{
                if( tObj.msg == "-2" ){
                    $.prompt(a_54 + a_12222);
                }else{
                    $.prompt(a_54);
                }
            }
            window.parent.unblock_func();
        }else if(action.indexOf("setgroup") != -1 ){
            var tObj = eval("(" + data + ")");
            if( tObj.res == "success" ){
                var newid = parseInt(tObj.msg);
                var disname = $("#newgroupname").val();
                var groupsdiv = document.getElementById('addgroups');
                var checkbox = document.createElement('INPUT');
                checkbox.type = 'checkbox';
                checkbox.className = "inputcbx";
                checkbox.id = "addgroup_" + newid;
                checkbox.setAttribute("groupid", newid);
                checkbox.setAttribute("groupname", disname);
                var spantext = document.createElement('SPAN');
                spantext.innerHTML = htmlEncode(disname);
                spantext.setAttribute("title", disname);
                groupsdiv.appendChild(checkbox);
                groupsdiv.appendChild(spantext);
                var brbox = document.createElement('BR');
                groupsdiv.appendChild(brbox);
            }else{
                $.prompt(a_7363);
            }
        }else{
            mOptionNumDone ++;
            var tObj = eval("(" + data + ")");
            var staypage = 0;
            if( tObj.res == "success" ){
                mOptionNumSuc ++;
                if( action.indexOf("removecallconf" ) != "-1" )
                {
                    $("#divcallbtn").appendTo($("#itemsdiv")).hide();
                    $("#rightdivcallbtn").appendTo($("#logitemsdiv")).hide();
                    if( tObj.msg == "" ){
                        //this is callback when clear all conf history
                        $(".itemdiv, .logitemdiv").remove();
                        create_nocall_div();
                    }else{
                        staypage = 0;
                        var tmpid = tObj.msg;
                        var conflogids = tmpid.split(",");
                        for(var i = 0; i < conflogids.length; i++){
                            $("#conflog_"+conflogids[i]).remove();
                            $(".rightitemdiv[confid="+conflogids[i]+"]").remove(); 
                        }    
                    }
                }else if( action.indexOf("removecall" ) != "-1" )//removecallconf or removecallbynumber also will go into this, so check this at last
                {
                    $("#divcallbtn").appendTo($("#itemsdiv")).hide();
                    $("#rightdivcallbtn").appendTo($("#logitemsdiv")).hide();
                    var tmpid = tObj.msg;  
                    if( action.indexOf("flag=0" ) != "-1" ){
                        //this is callback when remove a single callhistory
                        $("#calllog_"+tmpid).remove();
                        //$("#memberlog_"+tmpid).remove();
                    }else if( action.indexOf("flag=2" ) != "-1" ){
                        //this is callback when remove callhistory by number 
                        var logids = tmpid.split(",");
                        var curlogid;
                        for(var i = 0; i < logids.length; i++){
                            curlogid = logids[i];
                            $("#memberlog_"+curlogid).remove();
                            if( $("#calllog_"+curlogid).length > 0 )
                                $("#calllog_"+curlogid).remove();
                        }
                    }else{
                        //this is callback when clear all missed, outgoing or incoming callhistorys 
                        staypage = 1;
                        $(".itemdiv, .rightitemdiv").remove();
                        create_nocall_div();
                    } 
                }else if( action.indexOf("clearallcallhistory") != "-1" ){
                    $(".itemdiv, .rightitemdiv").remove();
                    create_nocall_div();
                }
            }
            if( mOptionNum == mOptionNumDone ){
                window.parent.unblock_func();
                if( mOptionNumSuc == 0 ){
                    $.prompt(a_58);
                }else if( mOptionNum == mOptionNumSuc ){
                    //$.prompt(a_del_ok);
                    if( $(".itemdiv:visible").length == 0 ){
                        $("#a_detailstitle").text("");
                        $("#selectall").attr("checked", false);
                        $("#delcontact, #logitemsdiv").hide();
                        create_nocall_div();
                    }else if( staypage == 0 ){
                        $(".itemdiv:visible").eq(0).click(); 
                    }
                }else{
                    $.prompt(a_16428);
                }
            }
        }
    }else{
        var msgs = res_parse_rawtext(data);
        cb_if_auth_fail(msgs);
        if (cb_is_fail(msgs)){}   
        else {
            if(action == "status&region=status"){
                cb_get_status_done(msgs);
            }
            else if(action = "get&var-0000=2382"){
                var disdialplan = msgs.headers['2382'];
                if(disdialplan == "" || disdialplan == undefined)
                    disdialplan = 0;
                else
                    disdialplan = parseInt(disdialplan).toString(2);
                
                mDisdialplan[3] = 1;  // incoming call
                mDisdialplan[4] = 1;  // outgoing call

                var length = disdialplan.length;
                switch (length) {
                    case 3:
                        if(disdialplan.substring(0, 1) == 1)
                            mDisdialplan[3] == 0;
                        break;
                    case 4:
                        if(disdialplan.substring(1, 2) == 1)
                            mDisdialplan[3] = 0;
                        if(disdialplan.substring(0, 1) == 1)
                            mDisdialplan[4] = 0;
                        break;
                    case 5:
                        if(disdialplan.substring(2, 3) == 1)
                            mDisdialplan[3] = 0;
                        if(disdialplan.substring(1, 2) == 1)
                            mDisdialplan[4] = 0;
                }
            }
        }
    }
}
function remove_conf_member_by_id(confid, memberid){
    var mids = $("#conflog_"+confid).attr("mids");
    var tmids = mids.split(":::");
    var tnames = $("#conflog_"+confid).attr("mnames").split(":::");
    var tnumbers = $("#conflog_"+confid).attr("number").split(":::");
    var tdates = $("#conflog_"+confid).attr("mdates").split(":::");
    var tisvideo = $("#conflog_"+confid).attr("misvideo").split(":::");
    var tiscontact = $("#conflog_"+confid).attr("miscontact").split(":::");
    var ttype = $("#conflog_"+confid).attr("mtype").split(":::");
    var tdurations = $("#conflog_"+confid).attr("mdurations").split(":::");
    var nmids = "", nnames = "", nnumbers = "", ndates = "", niscontact = "", ntype = "", nisvideo = "", ndurations = "";
    for( var i = 0; i < tmids.length; i++ ){
        if( tmids[i] != memberid ){
            if( nmids != "" ){
                nmids += ":::";
                nnames += ":::";
                nnumbers += ":::";
                ndates += ":::";
                niscontact += ":::";
                ntype += ":::";
                nisvideo += ":::";
                ndurations += ":::";
            }
            nmids += tmids[i];
            nnames += tnames[i];
            nnumbers += tnumbers[i];
            ndates += tdates[i];
            niscontact += tiscontact[i];
            ntype += ttype[i];
            nisvideo += tisvideo[i];
            ndurations += tdurations[i];
        }
    }
    $("#conflog_"+confid).attr("mids", nmids).attr("mnames", nnames).attr("number", nnumbers).attr("mdurations", ndurations).attr("mdates", ndates).attr("misvideo", nisvideo).attr("miscontact", niscontact).attr("mtype", ntype);
}
function translate_page(){
    $("#loadmorelogs").text(a_19003);
    //$("#addtocontact").text(a_416);
    $("#a_detailname").text(a_7474);
    $("#a_detailnum").text(a_317);
    $("#a_detailemail").text(a_302);
    $("#a_detailgroups").text(a_4749);
    $("#addnewnumspan, #addnewemailspan").text(a_14004);
    $("#newgroupbtn, #a_newgroup").text(a_4838);
    $("#addnewgroup").text(a_2);
    $("#cancelnewgroup").text(a_3);
    $("#savebtn").text(a_17);
    $("#cancelbtn").text(a_3);
    $("#delcontact").text(a_19067);
    //$("#editbtn").text(a_22);
    $("#selectcancel").text(a_3);
    $("#selectcall").text(a_504);
    $("#addschedule").text(a_23);
    for(var i = 0; i < mNumberTypes.length; i++){
        $("#addsipnumtype0 option").eq(i).text(mNumberTypes[i]);
    }
    for(i = 0; i < mEmailTypes.length; i++){
        $("#addemailtype0 option").eq(i).text(mEmailTypes[i]);
    }
}
function cb_get_action_nocallback(action){
	var urihead = "action=" + action;
    urihead += "&time=" + new Date().getTime();
    $.ajax ({
        type: 'get',
        url:'/manager',
        data:urihead,
        dataType:'text',
        success:function(data) {
            //cb_get_action_done(data, action);
        },
        error:function(xmlHttpRequest, errorThrown) {
            cb_networkerror(xmlHttpRequest, errorThrown);
        }
    });
}
/*function add_conf_member(){
    if( mNumberarray.length > 0 ){
        cb_get_action("originatecall&region=webservice&destnum=" + encodeURIComponent(mNumberarray[0]) + "&account=" + mAcctarray[0] + "&isvideo=1&isdialplan=1&headerstring=&format=json");
        mNumberarray.splice(0, 1);
        mAcctarray.splice(0, 1);
        setTimeout('add_conf_member();', 1000);
    }
}*/
function create_detail_number_div(newid)
{
    if( $("#detailnum" + newid + "div").length != 0 ) return;
    var detaildiv = document.createElement('DIV');
    detaildiv.className='detaildiv detailnumdiv';
    detaildiv.id = "detailnum" + newid + "div";
    var desdiv = document.createElement('DIV');
    desdiv.className='desdiv';
    var destext = document.createElement('SPAN');
    destext.innerHTML = htmlEncode(a_317);
    desdiv.appendChild(destext);
    detaildiv.appendChild(desdiv);

    var editdiv = document.createElement('DIV');
    editdiv.className='editdiv';
    var editnumselect = document.createElement('SELECT');
    editnumselect.id = "addsipnumtype" + newid;
    editnumselect.className='acctselect';
    for(j = 0; j < 20; j++ ){
        var optiontext = "";
        var toption=document.createElement("OPTION");
        editnumselect.appendChild(toption);
        toption.value=(j+1);
        toption.text=mNumberTypes[j];
    }
    editdiv.appendChild(editnumselect); 
    var editacctselect = document.createElement('SELECT');
    editacctselect.id = "addsipacct" + newid;
    editacctselect.className='acctselect';
    for(var j = 0; j < mMaxAccount; j++ ){
        var optiontext = "";
        var toption=document.createElement("OPTION");
        editacctselect.appendChild(toption);
        toption.value=j;
        toption.text=mAcctName[j];
    }
    editdiv.appendChild(editacctselect); 
    var editinput = document.createElement('INPUT');
    editinput.id = "addsipnum" + newid;
    editinput.className = "numinput"; 
    editinput.setAttribute("type", "text");
    editdiv.appendChild(editinput);
    
    var delicon = document.createElement('BUTTON');
    delicon.id = "delnumber" + newid;
    delicon.className='delcontacticon';
    delicon.setAttribute("numberid", newid);
    $(delicon).bind("click", function(){ deleteNumber($(this).attr("numberid")); });
    //delicon.onClick = deleteNumber;
	//delicon.addEventListener("click",deleteNumber,false); 
    editdiv.appendChild(delicon);
    detaildiv.appendChild(editdiv);
    
    mDetailParentDivObj.insertBefore(detaildiv, mInsertBeforeNumObj);
}
function deleteNumber(idattr){
    var id = parseInt(idattr);//$(this).attr("numberid")
    $("#detailnum" + id + "div").remove();
    if( id < mEditNumberNum -1 ){
        var newid;
        for( var i = id+1; i < mEditNumberNum; i++ ){
            newid = i-1;
            $("#addsipacct" + i).attr("id", "addsipacct" + newid);
            $("#addsipnum" + i).attr("id", "addsipnum" + newid);
            $("#addsipnumtype" + i).attr("id", "addsipnumtype" + newid);
            $("#delnumber" + i).attr("id", "delnumber" + newid).attr("numberid", newid);
            $("#detailnum" + i + "div").attr("id", "detailnum" + newid + "div");
        }
    }
    mEditNumberNum --;
}
function create_detail_email_div(newid)
{
    if( $("#detailemail" + newid + "div").length != 0 ) return;
    var detaildiv = document.createElement('DIV');
    detaildiv.className='detaildiv detailemaildiv';
    detaildiv.id = "detailemail" + newid + "div";
    var desdiv = document.createElement('DIV');
    desdiv.className='desdiv';
    var destext = document.createElement('SPAN');
    destext.innerHTML = htmlEncode(a_302);
    desdiv.appendChild(destext);
    detaildiv.appendChild(desdiv);

    var editdiv = document.createElement('DIV');
    editdiv.className='editdiv';
    var emailtypeselect = document.createElement('SELECT');
    emailtypeselect.id = "addemailtype" + newid;
    emailtypeselect.className='acctselect';
    for(j = 0; j < 4; j++ ){
        var optiontext = "";
        var toption=document.createElement("OPTION");
        emailtypeselect.appendChild(toption);
        toption.value=(j+1);
        toption.text=mEmailTypes[j];
    }
    editdiv.appendChild(emailtypeselect);
    var editinput = document.createElement('INPUT');
    editinput.className='emailinput';   
    editinput.id = "addemail" + newid;
    editinput.setAttribute("type", "text");
    editdiv.appendChild(editinput);
    
    var delicon = document.createElement('BUTTON');
    delicon.id = "delemail" + newid;
    delicon.className='delcontacticon';
    delicon.setAttribute("emailid", newid);
    $(delicon).bind("click", function(){ deleteEmail($(this).attr("emailid")); });
    //delicon.onClick = deleteEmail;
	//delicon.addEventListener("click",deleteEmail,false); 
    editdiv.appendChild(delicon);
    detaildiv.appendChild(editdiv);
    
    mDetailParentDivObj.insertBefore(detaildiv, mInsertBeforeEmailObj);
}
function deleteEmail(idattr){
    var id = parseInt(idattr);//$(this).attr("emailid")
    $("#detailemail" + id + "div").remove();
    if( id < mEditEmailNum -1 ){
        var newid;
        for( var i = id+1; i < mEditEmailNum; i++ ){
            newid = i-1;
            $("#addemail" + i).attr("id", "addemail" + newid);
            $("#addemailtype" + i).attr("id", "addemailtype" + newid);
            $("#delemail" + i).attr("id", "delemail" + newid).attr("emailid", newid);
            $("#detailemail" + i + "div").attr("id", "detailemail" + newid + "div");
        }
    }
    mEditEmailNum --;
}
function cb_get_status_done(msgs) {
    if (msgs.headers['account_0_name'].length > 0) {
        mAcctName[0] = msgs.headers['account_0_name'];
    }
    if (msgs.headers['account_1_name'].length > 0) {
        mAcctName[1] = msgs.headers['account_1_name'];
    }
    if( mOEMID == '54' ){
        mAcctName = new Array("SIP", "H.323");
        $("#addsipacct0 option:eq(1)").remove();
        mMaxAccount = 2;
    }
    /*if (msgs.headers['account_2_no'].length > 1) {
        mAcctName[2] = msgs.headers['account_2_name'];
    }
    if (msgs.headers['account_3_no'].length > 1) {
        mAcctName[3] = msgs.headers['account_3_name'];
    }
    if (msgs.headers['account_4_no'].length > 1) {
        mAcctName[4] = msgs.headers['account_4_name'];
    }
    if (msgs.headers['account_5_no'].length > 1) {
        mAcctName[2] = msgs.headers['account_5_name'];
    }*/
    for(var i = 0; i < mMaxAccount; i++){
        $("#addsipacct0 option:eq(" + i + ")").text(mAcctName[i]);
    }
    
    for(var i = 0; i < 7; i++){
        var acctstatus = {};
        acctstatus.activate = msgs.headers['account_' + i + '_activate'];
        acctstatus.status = msgs.headers['account_' + i + '_status'];
        mAcctStatus.push(acctstatus);
    }
}
function pageEventActions(){
    $("#loadmorelogs").click(function(){
        window.parent.block_download_func(a_6660);
        parse_left_items_by_time(1);
        window.parent.unblock_func();
    });
     
    $("#dialnow,#search").hover(function(){
            $(this).css("borderColor","#73e6f3").siblings().css("borderColor","#73e6f3");
        },function(){
            $(this).css("borderColor","#d9d9d9").siblings().css("borderColor","#d9d9d9");
    });
    $("#itemcallbtn, #rightitemcallbtn, #itemdelbtn").mouseover(function(){
        $(this).addClass('buttonover');
    }).mouseout(function(){
        $(this).removeClass('buttonover');
    });
    $("#itemdelbtn").click(function(){
        window.parent.block_download_func(a_59);
        mOptionNum = 1;
        mOptionNumSuc = 0;
        mOptionNumDone = 0;
        if( $(this).parent().parent(".itemdiv").attr("isconf") != "1" ){
            var delnumber = $(this).parent().parent(".itemdiv").attr("number");
            var delacct = $(this).parent().parent(".itemdiv").attr("account");
            if( $(this).parent().parent(".itemdiv").attr("loaded") == "0" ){
                get_calllog_by_number(delnumber, delacct, mLogType);
                $(this).parent().parent(".itemdiv").attr("loaded", "1");
            }
            var delId = "";
            $(".memberitemdiv[type=3][number=\""+delnumber+"\"][account="+delacct+"]").each(function(){
                if( delId != "" )
                    delId += ",";
                delId += $(this).attr("logid");
            });
            $("#divcallbtn").appendTo( $("#itemsdiv") ).hide();
            if( delId != "" )
                cb_get_action("removecall&region=webservice&flag=2&id=" + delId); 
            else
                window.parent.unblock_func();    
        }else{
            var delconfId = "";
            delconfId = $(this).parent().parent(".itemdiv").attr("confid");
            $("#divcallbtn").appendTo( $("#itemsdiv") ).hide();
            $("#rightdivcallbtn").appendTo($("#logitemsdiv")).hide();
            cb_get_action("removecallconf&region=webservice&confId=" + delconfId);
        }
    }); 
    $("#rightitemcallbtn").click(function(){
        var dialnum = $(this).parent().parent(".rightitemdiv").attr("number");
        if( dialnum == "" ){
            $.prompt(a_16665);
            return false;
        }
        if( dialnum == "anonymous" ){
            $.prompt(a_10083);
            return false;
        }
        var confstate = $("#disconfstate",window.parent.document).val();
        
        var dialacct = $(this).parent().parent(".rightitemdiv").attr("account");
        
        var isvideo = $(this).parent().parent().attr("isvideo");
        
        var type = $(this).parent().parent().attr("type");
        var isdialplan;
        if(type == 2)
            isdialplan = mDisdialplan[4];
        else
            isdialplan = mDisdialplan[3];
            
        if( dialacct == 2 ){
            cb_start_addmemberconf(dialnum, dialacct, "call","", isdialplan, "");
        }
        else{
            cb_start_single_call(dialnum, dialacct, 0, isdialplan, 0, isvideo);
        }
            
    });    
    
    $("#itemcallbtn").click(function(){
        var dialnum = $(this).parent().parent(".itemdiv").attr("number");
        var callmode = "call";
        if( dialnum == "" ){
            $.prompt(a_16665);
            return false;
        }
        if( dialnum == "anonymous" ){
            $.prompt(a_10083);
            return false;
        }
        var confstate = $("#disconfstate",window.parent.document).val();
        
        var dialacct = $(this).parent().parent(".itemdiv").attr("account");
        if( $(this).parent().parent(".itemdiv").attr("isconf") != "1" ){
            mMaxlineNum = mMaxMember - parseInt($("#busylinenum",window.parent.document).val());
            if( $("#hasipvt", window.parent.document).val() == "1" && mPromodel == "GVC3202" && mMaxlineNum < 2 ){
                mMaxlineNum ++;
            }
            if( mMaxlineNum > 0 ) {
                var isdialplan, type;
                var logid = $(this).parent().parent(".itemdiv").attr("logid");
                if(logid != undefined)
                    type = $(".memberitemdiv[logid=" + logid + "]").attr("type");
                
                if(type == 2)
                    isdialplan = mDisdialplan[4];
                else
                    isdialplan = mDisdialplan[3];
                    
                $(this).parent().parent(".itemdiv").click();
                var isvideo =  $(".memberitemdiv[logid=" + logid + "]:first").attr("isvideo");
                cb_start_single_call(dialnum, dialacct, 0, isdialplan, 0, isvideo);
            }
            else{
                $.prompt(a_10097);
            }
        }else{
            if(confstate == "1")
            {
                $.prompt(a_560);
                return false;
            }
            //dialnum = dialnum.substring(1, dialnum.length-1);
            //dialnum = dialnum.replace(/,/g,":::");
            var dialnumarray = dialnum.split(":::");
            var dialacctarray = dialacct.split(":::");
            var dialname = $(this).parent().parent(".itemdiv").attr("disname");
            var names = dialname.split(",");
            var membersnum = dialnumarray.length;
            var todialnum = "", todialacct = "";
            mMaxlineNum = mMaxMember - parseInt($("#busylinenum",window.parent.document).val());
            if( $("#hasipvt", window.parent.document).val() == "1" && mPromodel == "GVC3202" && mMaxlineNum < 2 ){
                mMaxlineNum ++;
            }
            if( membersnum > mMaxlineNum)
            {
                //list all members
                $("#selectlist").empty();
                for(var i = 0; i < membersnum; i++){
                    if( dialnumarray[i] == "anonymous" )
                        continue;
                    var listdiv = "<div number='"+dialnumarray[i]+"' account='0'>";
                    if(i < mMaxlineNum)
                        listdiv += "<input type='checkbox' checked='checked'/>";
                    else
                        listdiv += "<input type='checkbox' />";
                    listdiv += "<span title='"+names[i]+"'>"+htmlEncode(names[i])+"</span>";
                    listdiv += "<span title='"+dialnumarray[i]+"'>"+htmlEncode(dialnumarray[i])+"</span>";
                    listdiv += "</div>";

                    $("#selectlist").append(listdiv);
                }
                add_selectlist_event();
                $("#addschedule").hide();
                $("#selectcall").show();
                $("#selectcalldiv").show();
                return false;
            }
            callmode = "ipcall";
            for( var i = 0; i < membersnum; i++ ){
                if( dialnumarray[i] == "anonymous" )
                    continue;
                if(callmode == "ipcall")
                {
                    if(!mIPtest.test(dialnumarray[i].split(":")[0]))
                    {
                        //if find a number is not ip, set callmode to "call"
                        callmode = "call";
                    }
                }
                if ( todialnum != "" ){
                    todialnum += ":::";
                    todialacct += ":::";
                }
                todialnum += dialnumarray[i];
                todialacct += dialacctarray[i];
            }
            if(todialnum == ""){
                $.prompt(a_16665);
                return false;
            }
            /*var confname = "";
            if( $(this).parent().parent(".itemdiv").attr("confid") != "" )
                confname = encodeURIComponent($(this).parent().parent(".itemdiv").attr("name"));*/
            var confid = $(this).parent().parent(".itemdiv").attr("confid");
            var confname = $(this).parent().parent(".itemdiv").attr("name");
            //cb_get_action("addconfmemeber&region=confctrl&numbers=" + encodeURIComponent(dialnum) + "&accounts=" + encodeURIComponent(todialacct) + "&confname=" + confname);
            //cb_start_addmemberconf(dialnum, todialacct, callmode, confname);
            var isdialplan = "";
            $(".memberitemdiv[confid" + confid + "]").each(function(){
                var calllogtype = $(this).attr("type");
                if(calllogtype == 2)
                    isdialplan += mDisdialplan[4] + ":::";
                else
                    isdialplan += mDisdialplan[3] + ":::";
            });
            isdialplan = isdialplan.substring(0, isdialplan.length - 3);
            
            var isvideo = $(this).parent().parent(".itemdiv").attr("misvideo");
            cb_start_addmemberconf(dialnum, todialacct, callmode, confid, isdialplan, confname, isvideo);
            
            /*var confid = $(this).parent().parent(".itemdiv").attr("confid");
            if( confid != "" )
                cb_get_action("originatecallconf&region=webservice&confId=" + confid);
            else{
                var numbers = $(this).parent().parent(".itemdiv").attr("number").split("-");
                var accts = $(this).parent().parent(".itemdiv").attr("account").split(",");
                cb_get_action("originatecall&region=webservice&destnum=" + encodeURIComponent(numbers[1]) + "&account=" + accts[0] + "&isvideo=1&isdialplan=1&headerstring=&format=json");
                if( accts.length > 1 ){
                    mNumberarray.splice(0, mNumberarray.length);
                    mAcctarray.splice(0, mAcctarray.length);
                    for(var i = 1; i < accts.length; i++){
                        mNumberarray.push(numbers[i+1]);
                        mAcctarray.push(accts[i]);
                    }
                    setTimeout('add_conf_member();', 1000);
                }
            }*/
        }
    });
    
    $("#selectcall").click(function(){
        var nums = "";
        var accts = "";
        var num_member = 0;
        $("#selectlist input").each(function(){
            if($(this).prop("checked") == true)
            {
                var number = $(this).parent().attr("number");
                var account = $(this).parent().attr("account");
                if(nums == "")
                    nums += number;
                else
                    nums += ":::" + number;

                if(accts == "")
                    accts += account;
                else
                    accts += ":::" + account;

                num_member++;
            }
        });

        if(num_member == 0)
        {
            $(".selecttips").text(a_16436);
            setTimeout(function(){
                $(".selecttips").text("");
            },2000);
            return false;
        }

        cb_start_addmemberconf(nums, accts, $("#selectlist").attr("callmode"),"", "");
        $("#selectcalldiv").hide();
    });

    $("#addschedule").click(function(){
        var nums = "";
        var names = "";
        var accounts = "";
        var num_member = 0;
        $("#selectlist input").each(function(){
            if($(this).prop("checked") == true)
            {
                var number = $(this).parent().attr("number");
                var name = $(this).parent().attr("name");
                var account = $(this).parent().attr("account");
                if(nums == "")
                    nums += number;
                else
                    nums += ":::" + number;

                if(names == "")
                    names += name;
                else
                    names += ":::" + name;

                if(accounts == "")
                    accounts += account;
                else
                    accounts += ":::" + account;

                num_member++;
            }
        });

        if(num_member == 0)
        {
            $(".selecttips").text(a_16436);
            setTimeout(function(){
                $(".selecttips").text("");
            },2000);
            return false;
        }

        $.cookie("addschedulenumber", nums, {path: '/', expires:10});
        $.cookie("addschedulename", names, {path: '/', expires:10});
        $.cookie("addscheduleacct", accounts, {path: '/', expires:10});
        $("#selectcalldiv").hide();
        $(".apps\\/schedule\\.html", window.parent.document).click();
    });

    $("#closecalldiv,#selectcancel").click(function(){
        $("#selectcalldiv").hide();
    });

    $("#addnewnumspan,.addnumicon").click(function(){
        //since id is start from 0,so do not plus first
        create_detail_number_div(mEditNumberNum);
        $("#addsipnum"+mEditNumberNum).val("");
        $("#detailnum" + mEditNumberNum + "div").show();
        if( $("#detailnum" + mEditNumberNum + "div").children(".editdiv").children(".newListSelected").length == 0 ){
            $("#addsipacct"+mEditNumberNum).sSelect();
            $("#addsipnumtype"+mEditNumberNum).sSelect({ddMaxHeight:'200px'});
        }
        mEditNumberNum ++; 
    });
    
    $("#addnewemailspan,.addemailicon").click(function(){
        //since id is start from 0,so do not plus first
        create_detail_email_div(mEditEmailNum);
        $("#addemail"+mEditEmailNum).val("");
        $("#detailemail" + mEditEmailNum + "div").show();
        if( $("#detailemail" + mEditEmailNum + "div").children(".editdiv").children(".newListSelected").length == 0 ){
            $("#addemailtype"+mEditEmailNum).sSelect();
        }
        mEditEmailNum ++; 
    });
    
    $("#savebtn").click(function(){
        var addname = $.trim($("#addname").val());
        if( addname == "" ){
            $.prompt(a_7435);
            return false;
        }
        window.parent.block_download_func(a_8104);
        var gpid = new Array();
        $("#addgroups .inputcbx").each(function(index, item) {
            if( $(item).prop("checked") ){
                gpid.push($(item).attr("groupid"));
                /*if( gpid != "" )
                    gpid += ",";
                gpid += $(item).attr("groupid");*/
            }
        });
        var infostr = '{"rawcontact":{';
        infostr += '},"structuredname":{"displayname":"';
        infostr += addname.replace(/\\/g, "\\\\").replace(/\"/g, "\\\"");
        infostr += '"},"groupmembership":[';
        
        var groupstr = "";
        for( var i = 0; i < gpid.length; i++){
            if( i > 0 )
                groupstr += ',';
            groupstr += '{"groupid":"';
            groupstr += gpid[i];
            groupstr += '"}';
        }
        infostr += groupstr;
        infostr += '],"phone":[';
        var numberstr = "";
        var curnumbernum = mEditNumberNum;
        if( mEditNumberNum == 0 && $.trim( $("#addsipnum0").val() ) != "" ){
            curnumbernum = 1;
        }
        for( i = 0; i < curnumbernum; i++){
            if( $.trim( $("#addsipnum" + i).val() ) == "" ) continue;
            if( numberstr != "" )
                numberstr += ',';
            numberstr += '{"type":"';
            numberstr += $("#addsipnumtype" + i).val();
            numberstr += '","account":"';
            numberstr += $("#addsipacct" + i).val();
            numberstr += '","number":"';
            numberstr += $("#addsipnum" + i).val().replace(/\\/g, "\\\\").replace(/\"/g, "\\\"");
            numberstr += '"}';
        }
        infostr += numberstr;
        infostr += '],"email":[';
        var emailstr = "";
        var curemialnum = mEditEmailNum;
        if( mEditEmailNum == 0 && $.trim( $("#addemail0").val() ) != "" ){
            curemialnum = 1;
        }
        for( i = 0; i < curemialnum; i++){
            if( $.trim( $("#addemail" + i).val() ) == "" ) continue;
            if( emailstr != "" )
                emailstr += ',';
            emailstr += '{"type":"';
            emailstr += $("#addemailtype" + i).val();
            emailstr += '","address":"';
            emailstr += $("#addemail" + i).val().replace(/\\/g, "\\\\").replace(/\"/g, "\\\"");
            emailstr += '"}';
        }
        infostr += emailstr;
        infostr += ']}';
        
        cb_get_action("setcontact&region=webservice&contactInfo=" + encodeURIComponent(infostr) + "&format=json"); 
    });
    
    $("#cancelbtn").click(function(){
        if( mEditMode == 2 ){
            $("#logitemsdiv").show();
            $("#persondiv, #savebtn").hide();
            mEditMode = 0;  //must before the follow click event
            $("#"+selectid).click();
        }else if( mEditMode == 1 ){
            mEditMode = 0;
            //$("#logitemsdiv .logitemdiv[name=\"" + $("#a_detailstitle").attr("title") + "\"]").each(function(){
            $("#logitemsdiv .logitemdiv:visible").each(function(){
                $(this).children(".delicondiv").remove();
                /*if( $(this).attr("isconf") == "1" )
                    $(this).children(".logitemtopdiv").children(".delicondiv").remove();
                else
                    $(this).children(".delicondiv").remove();*/
            });
        }
        $("#cancelbtn").hide();
        //$("#editbtn").show(); 
    });
    
    $(".itemcheck .inputcbx").live("click", function() {
        if ($(this).prop("checked") != true) {
            var isall = 1;
            $("#selectall").removeAttr("checked");//.button("refresh");
            $(".itemcheck .inputcbx").each(function(index, item) {
                if ($(item).prop("checked") == true) {
                    isall = 0;
                    return false;   
                }
            });

            if(isall == 0)
                $("#delcontact").removeAttr("disabled").removeClass("deldisable");
            else
                $("#delcontact").attr("disabled","disabled").addClass("deldisable");

        } else {
            var isall = 1;
            $(".itemcheck .inputcbx").each(function(index, item) {
                if ($(item).prop("checked") != true) {
                    isall = 0;
                    return false;   
                }
            });

            if (isall == 1)
                $("#selectall").attr("checked", "checked");//.button("refresh");

            $("#delcontact").removeAttr("disabled").removeClass("deldisable");
        }
    });

    $("#selectall").click(function(){
        if ($(this).prop("checked") == true) {
            $(".itemcheck .inputcbx").attr("checked", "checked");//.button("refresh");
            $("#delcontact").removeAttr("disabled").removeClass("deldisable");
        } else {
            $(".itemcheck .inputcbx").removeAttr("checked");//.button("refresh");
            $("#delcontact").attr("disabled","disabled").addClass("deldisable");
        }
    });
    
    $("#delcontact").click(function(){
        var txt = '<div class="shortmsg">' + a_9334 + '</div>';
        $.prompt(txt,{
            buttons:{
                Yes: true, No: false
            },
            callback: function(v,m,f){
                if(v) {  
                    window.parent.block_download_func(a_59);
                    mOptionNum = 0;
                    mOptionNumSuc = 0;
                    mOptionNumDone = 0;
                    if( $("#selectall").prop("checked") == true ){
                        mOptionNum = 1;
                        if( mLogType == 0 ){
                            cb_get_action("clearallcallhistory&region=webservice");
                        }else{
                            cb_get_action("removecall&region=webservice&flag=1&id=" + mDeleteType); 
                        }
                    }else{
                        var delconfId = "";
                        var delId = "";
                        $(".itemcheck .inputcbx").each(function(index, item) {
                            if ($(item).prop("checked") == true) {
                                if( $(this).parent().parent(".itemdiv").attr("isconf") != "1" ){
                                    var delnumber = $(this).parent().parent(".itemdiv").attr("number");
                                    var delacct = $(this).parent().parent(".itemdiv").attr("account");
                                    if( $(this).parent().parent(".itemdiv").attr("loaded") == "0" ){
                                        get_calllog_by_number(delnumber, delacct, mLogType);
                                        $(this).parent().parent(".itemdiv").attr("loaded", "1");
                                    }
                                    $(".memberitemdiv[number=\""+delnumber+"\"][account="+delacct+"]").each(function(){
                                        if( delId != "" )
                                            delId += ",";
                                        delId += $(this).attr("logid");
                                    });
                                    $("#divcallbtn").appendTo( $("#itemsdiv") ).hide();
                                }else{
                                    if( delconfId != "" )
                                        delconfId += ",";
                                    delconfId += $(this).parent().parent(".itemdiv").attr("confid");
                                    $("#divcallbtn").appendTo( $("#itemsdiv") ).hide();
                                    $("#rightdivcallbtn").appendTo($("#logitemsdiv")).hide();
                                    
                                }
                            }
                        });
                        var del = 0;
                        if( delId != "" ){
                            del = 1;
                            mOptionNum ++;
                            cb_get_action("removecall&region=webservice&flag=2&id=" + delId); 
                        }
                        if( delconfId != "" ){
                            del = 1;
                            mOptionNum ++;
                            cb_get_action("removecallconf&region=webservice&confId=" + delconfId);
                        }
                        if( del == 0 )
                            window.parent.unblock_func();    
                    }
                }
                else {}
            }
        });
    });
    
    $("#addtocontact, #rightaddtocontact").click(function(){
        if( mEditMode != 0 ) {
            $("#cancelbtn").click();
        }
        mEditMode = 2;
        mEditNumberNum = 1;
        mEditEmailNum = 1;
        $("#a_detailstitle").text(a_416);
        $("#logitemsdiv, .detailnumdiv, .detailemaildiv").hide();
        $("#addemail0").val("");
        $("#persondiv, #savebtn, #cancelbtn, #detailnum0div, #detailemail0div").show();
        if( $("#detailnum0div").children(".editdiv").children(".newListSelected").length == 0 ){
            $("#addsipnumtype0").sSelect({ddMaxHeight:'200px'});
            $("#addsipacct0").sSelect();
            $("#addemailtype0").sSelect();
        }
        var addname = "";
        var addnumber = "";
        var addacct = "";
        if( $(this).attr("id") == "rightaddtocontact" ){
            addname = $(this).parent().parent(".rightitemdiv").attr("disname");
            addnumber = $(this).parent().parent(".rightitemdiv").attr("number");
            addacct = $(this).parent().parent(".rightitemdiv").attr("account");
        }else{
            addname = $(this).parent().parent(".itemdiv").attr("disname");
            addnumber = $(this).parent().parent(".itemdiv").attr("number");
            addacct = $(this).parent().parent(".itemdiv").attr("account");
        }
        $("#addsipnum0").val( addnumber ).attr("disabled", "disabled");
        //addacct = parseInt(addacct);
        $("#addsipacct0").getSetSSValue( addacct );
        $("#addsipacct0").next(".newListSelected").attr("disabled", "disabled").addClass("newListDisabled");
        $("#addgroups .inputcbx").each(function(index, item) {
            $(item).attr("checked", false);
        });
        $("#addname").val(addname).focus();
        if( mInitGroup == 0 ){
            get_groups();//setTimeout("get_groups()", 100);
            mInitGroup = 1;
        }
        return false;
    });
    
    $("#addtoschedule").click(function(){
        var dialnum = $(this).parent().parent(".itemdiv").attr("number");
        var dialname = "";
        if( $(this).parent().parent(".itemdiv").attr("isconf") == "1" )
            dialname = $(this).parent().parent(".itemdiv").attr("mnames");
        else
            dialname = $(this).parent().parent(".itemdiv").attr("disname");
        var dialacct = $(this).parent().parent(".itemdiv").attr("account");
        
        var recordfrom = "";
        if( $(this).parent().parent(".itemdiv").attr("isconf") == "1" ){
            recordfrom = $(this).parent().parent(".itemdiv").attr("mtype");
            var rcdarray = recordfrom.split(":::");
            recordfrom = "";
            for(var i = 0; i < rcdarray.length; i++){
                if(rcdarray[i] == 1 || rcdarray[i] == 3)
                    recordfrom += "3:::";
                else
                    recordfrom += "4:::";
            }
            recordfrom = recordfrom.substring(0, recordfrom.length - 3);
        }
        else
            recordfrom = 3;
        if( dialnum == "" ){
            $.prompt(a_16665);
            return false;
        }
        if( dialnum == "anonymous" ){
            $.prompt(a_15020);
            return false;
        }
        var dialnumarray = dialnum.split(":::");
        var dialacctarray = dialacct.split(":::");
        var names = dialname.split(":::");
        var membersnum = dialnumarray.length;
        var todialnum = "";
        if( membersnum > mMaxMember)
        {
            //list all members to add schedule
            $("#selectlist").empty();
            for(var i = 0; i < membersnum; i++){
                if( dialnumarray[i] == "anonymous" )
                    continue;
                var listdiv = "<div number='"+dialnumarray[i]+"' account='"+dialacctarray[i]+"' name='"+names[i]+"'>";
                if(i < mMaxMember)
                    listdiv += "<input type='checkbox' checked='checked'/>";
                else
                    listdiv += "<input type='checkbox' />";
                listdiv += "<span title='"+names[i]+"'>"+htmlEncode(names[i])+"</span>";
                listdiv += "<span title='"+dialnumarray[i]+"'>"+htmlEncode(dialnumarray[i])+"</span>";
                listdiv += "</div>";

                $("#selectlist").append(listdiv);
            }
            add_selectlist_event();
            $("#addschedule").show();
            $("#selectcall").hide();
            $("#selectcalldiv").show();
            return false;
        }
        else
        {
            $.cookie("addschedulenumber", dialnum, {path: '/', expires:10});
            $.cookie("addschedulename", dialname, {path: '/', expires:10});
            $.cookie("addscheduleacct", dialacct, {path: '/', expires:10});
            $.cookie("addrecordfrom", recordfrom, {path: '/', expires:10});
            $(".apps\\/schedule\\.html", window.parent.document).click();
        }
    });
    
    $("#newgroupname").bind('input propertychange', function() {
        var text = $.trim($(this).val());
        if( text == "" ){
            $("#addnewgroup").attr("disabled","disabled");
        }else{
            $("#addnewgroup").removeAttr("disabled")
        }
    });
    
    $("#newgroupbtn").click(function(){
        $("#newgroupname").val("");
        $("#addnewgroup").attr("disabled", "disabled");
        $("#newgroupdiv").show();
    });
    
    $("#addnewgroup").click(function(){
        var newname = $.trim($("#newgroupname").val());
        if( newname != "" ){
            if( $("#addgroups input[groupname=\"" +newname + "\"]").length > 0 ){
                $.prompt(a_4834);
            }else{
                cb_get_action("setgroup&region=webservice&groupInfo=:::" + encodeURIComponent(newname) + "&format=json"); 
            }
        }
        $("#newgroupdiv").hide();
    });
    
    $("#cancelnewgroup").click(function(){
        $("#newgroupdiv").hide();
    });
}

</script>

</body>

</html>
