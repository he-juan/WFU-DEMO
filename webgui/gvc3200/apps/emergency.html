<!-- saved from url=(0022)http://internet.e-mail -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link href='../css/pageframe.css' type='text/css' rel='stylesheet'>
<script type='text/javascript' src='../js/jquery.tools.min.js'></script>	
<script type="text/javascript" src='../js/jquery.validate.min.js'></script>
<script type="text/javascript" src='../js/jquery.cookie.js'></script>
<script type="text/javascript" src='../js/jquery.stylish-select.min.js'></script>

<body id="framebody">
<div class="tooltip"></div>

<div id="mainbody" class="maindiv">
    <div class="navi"><span id="a_ldap">LDAP Book</span></div>
    <div id="statusdiv"></div>
    <form action="" method="get" id="Formvalidate">
        <fieldset>
            <div webtip="Emergency Call Numbers" style="width:780px;">
                <div class="noreboot"><span id="a_icecontacts">Emergency Call Numbers</span> :</div>
                <div>
                    <div style="width:155px;">
                        <select multiple="multiple" style="height:120px;width:100%" name="icecontacts" id="icecontacts" />
                        </select>
                    </div>
                    <div style="width:100px;padding:0;margin:50px 0 0 12px !important;"><button id="deleteice" type="button">Delete</button></div>
                </div>
            </div>
            <div webtip="">
                <div class="noreboot"><span> </span></div>
                <input type="text" id="editicetext" style="width:150px;" />
                <button id="addice" type="button" style="margin-left:8px;margin-top:-4px;">Add</button>
            </div>
        </fieldset>
        <div class="savediv">
            <button id="a_save" type="button" class="savebtn">Save</button>
            <button id="a_cancel" type="reset" class="cancelbtn">Cancel</button>
        </div>
	</form>

<input type="text" id="icecontactspvalue" value="" style="display:none;" />
</div>
<script type="text/javascript">
	var cookie_lang = $.cookie( "MyLanguage");
    if ( !cookie_lang ){
        cookie_lang = 'en';
	}
	if ( cookie_lang == 'zh' ){
        document.write("<script src='../js/jquery.validate.messages_cn.js'><\/script>");
	}
    document.write("<script src='../lang/" + cookie_lang + ".js'><\/script>");

</script>
<script type="text/javascript" src='../js/public.js'></script>
<script type="text/javascript">
var req_items = new Array;
req_items.push(
    new ReqItem("icecontactspvalue", "25675", "")
);

$(function(){
	cb_get(req_items);
    $("#Formvalidate").validate({
		rules: {
        },
		errorElement: "em",
		success: function(label) { label.text(" ").addClass("success"); }
    });
    
    translate_emergency();
    pageEventActions();
});

function get_item_suc_callback(msgs) 
{
    var contactstext = msgs.headers['25675'];
	if( contactstext != undefined && contactstext != "" ){
        var contactstextlist = contactstext.split(",");
        for( var i = 0; i < contactstextlist.length; i++ ){
            if( contactstextlist[i] != "" ){
                var $toneopt = $("<option value='" + contactstextlist[i] + "'>" + htmlEncode(contactstextlist[i]) + "</option>");
                $('#icecontacts').append($toneopt);
            }
        }
    }
}

function translate_emergency(){
    $("#a_icecontacts").text(a_19255);
    $("#deleteice").text(a_21);
    $("#addice").text(a_23);
    $("#a_save").text(a_17);
    $("#a_cancel").text(a_3);
}

function pageEventActions(){
    $("#deleteice").click(function(){
        $("#icecontacts option:selected").remove();
    });
    
    $("#addice").click(function(){
        var editicetext = $.trim($("#editicetext").val());
        if( editicetext != "" ){
            if( editicetext.indexOf(",") != -1 ){
                $.prompt(a_nocomma);
            }else{
                var isExit = 0;
                for (var i = 0; i < $('#icecontacts option').length; i++) { 
                    if ($('#icecontacts option').eq(i).val() == editicetext ) { 
                        isExit = 1; 
                        break;
                    } 
                } 
                if( isExit == 1 ){
                    $.prompt(a_numberexist);
                }else{
                    var $toneopt = $("<option value='" + editicetext + "'>" + htmlEncode(editicetext) + "</option>");
                    $('#icecontacts').append($toneopt);
                    $("#editicetext").val("");
                }
            }
        }
    });
    
    $("#a_save").click(function(){
        if( !$("#Formvalidate").valid() ){
            view_message(a_16442,MSG_FAIL);
            return false;
        }
        
        var icecontacts = "";
        for(var i = 0; i < $("#icecontacts option").length; i++){
            if( i != 0 )
                icecontacts +=",";
            icecontacts += $("#icecontacts option").eq(i).val();
        }
        icecontacts = icecontacts.replace("\"", "\\\"");
        $("#icecontactspvalue").val(icecontacts);
        
        cb_put(req_items, "", 0);
    });
}
</script>

</body>

</html>
