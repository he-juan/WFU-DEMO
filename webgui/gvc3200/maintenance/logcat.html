<!-- saved from url=(0022)http://internet.e-mail -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link href='../css/pageframe.css' type='text/css' rel='stylesheet'>
<link href='../css/black_frame.css' type='text/css' rel='stylesheet' id="framecssfile">
<script type='text/javascript' src='../js/jquery.tools.min.js'></script>	
<script type="text/javascript" src='../js/jquery.cookie.js'></script>
<script type="text/javascript" src='../js/jquery.validate.min.js'></script>
<script type="text/javascript" src='../js/jquery.stylish-select.min.js'></script>
<body id="framebody" class="maintenancebody">
<div id="mainbody" class="maindiv">
    <div class="navi"><span id="a_logcat">Logcat</span></div>
    <div id="statusdiv"></div>
	<form action="" method="get" id="Formvalidate" onsubmit="return false">
		<fieldset>
            <div webtip="Clear Log">
                <div class="noreboot"><span id="a_clearlog">Clear Log</span> :</div>
                <button id="clearlog">Clear</button>
            </div>
            <div webtip="Log Tag">
                <div class="noreboot"><span id="a_logtag">Log Tag</span> :</div>
                <input name="logtag" type="text" id="logtag" />
            </div>
            <div webtip="Log Priority">
                <div class="noreboot"><span id="a_logpriority">Log priority</span> :</div>
                <select id="priority" name="priority">
                    <option value="V">Verbose</option>
                    <option value="D">Debug</option>
                    <option value="I">Info</option>
                    <option value="W">Warning</option>
                    <option value="E">Error</option>
                    <option value="F">Fatal</option>
                    <option value="S">Silent (supress all output)</option>
                </select> 
            </div>
            <div webtip="">
                <div class="noreboot"><span></span></div>
                <button id="getlognow" class="widebtn">Get</button><br/><br/>
            </div>
            <div id="mainlogcat" style="padding:10px 0 0 10px;margin-top:10px;margin-left:30px;">
                <iframe src="" id="logcatdiv" name="logcatFrame" frameborder="0" marginheight="0" marginWidth="0" onload="if($.browser.msie){logcatFrame.document.body.style.backgroundColor='transparent';}" scrollable="yes" allowTransparency="true" style="width:100%;height:100%"></iframe>
            </div>  
        </fieldset>
        
	</form>


</div>
<script type="text/javascript">
	var cookie_lang = $.cookie( "MyLanguage");
    var version = $.cookie("ver");
    if ( !cookie_lang ){
        cookie_lang = 'en';
	}
    if ( cookie_lang == 'zh' ){
        document.write("<script src='../js/jquery.validate.messages_cn.js'><\/script>");
	}
    if(!version)
        version = new Date().getTime();
    document.write("<script src='../js/public.js?ver=" + version + "'><\/script>");
    document.write("<script src='../lang/" + cookie_lang + ".js?ver=" + version + "'><\/script>");

</script>
<script type="text/javascript">
var req_items = new Array;
req_items.push(
    new ReqItem("priority", "208", "")
);

$(function(){
    setInitState();
    //cb_get(req_items);
    //cb_get_syslog();
    var height = parseInt($("#iframediv",parent.document.body).css('height'));
    $(".formDiv").css("height", height - 5);
    $("#mainlogcat").css("height", height - 280);
    
    pageEventActions();
});
function get_item_suc_callback(){
    
}
function setInitState(){
    translate_logcat();
    $("#priority").sSelect();
    $("#priority").getSetSSValue("V");
    $("#Formvalidate").validate({
		rules: { logtag: { maxlength: 32 } },
		errorElement: "em",
		success: function(label) { label.text(" ").addClass("success"); }
    });
}
function translate_logcat(){
    $("#a_clearlog").text(a_16353);
    $("#clearlog").text(a_31);
    $("#a_logtag").text(a_16354);
    $("#a_logpriority").text(a_16355);
    $("#getlognow").text(a_16356);
}
function cb_clear_logcat_suc(data)
{
    var msgs = res_parse_rawtext(data);
	cb_if_auth_fail(msgs);
	cb_if_is_fail(msgs);
    view_message(a_16464, MSG_OK);
    checkIsApplyNeed();
}
function cb_clear_logcat(){
	var urihead = "action=clearlogcat&region=maintenance";
    urihead += "&time=" + new Date().getTime();
    $.ajax ({
        type: 'get',
        url:'/manager',
        data:urihead,
        dataType:'text',
        success:function(data) {
            cb_clear_logcat_suc(data);
        },
        error:function(xmlHttpRequest, errorThrown) {
            cb_networkerror(xmlHttpRequest, errorThrown);
        }
    });
}
function cb_get_logcat_done(data)
{
    var msgs = res_parse_rawtext(data);
    cb_if_auth_fail(msgs);
    if (cb_is_fail(msgs)){
    }else {
        //change to txt suffix, as ie browser will download the link but not open
        setTimeout("$('#logcatdiv').attr('src','/logcat/logcat.txt?time=' + new Date().getTime());", 200);
        //parent.window.location = "/logcat/logcat?time=" + new Date().getTime();
    }
}
function cb_get_logcat(){
	var urihead = "action=getlogcat&region=maintenance&tag=" + encodeURIComponent($("#logtag").val()) + "&priority=" + $("#priority").val();
    urihead += "&time=" + new Date().getTime();
    $.ajax ({
        type: 'get',
        async: true,
        url:'/manager',
        data:urihead,
        dataType:'text',
        success:function(data) {
            cb_get_logcat_done(data);
        },
        error:function(xmlHttpRequest, errorThrown) {
            cb_networkerror(xmlHttpRequest, errorThrown);
        }
    });
}
function pageEventActions(){
    $("#clearlog").click(function(){
        cb_clear_logcat();
    });
    $("#getlognow").click(function(){
        cb_get_logcat();
    });
}

</script>

</body>

</html>
