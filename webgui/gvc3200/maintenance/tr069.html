<!-- saved from url=(0022)http://internet.e-mail -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link href='../css/pageframe.css' type='text/css' rel='stylesheet'>
<script type='text/javascript' src='../js/jquery.tools.min.js'></script>	
<script type="text/javascript" src='../js/jquery.cookie.js'></script>
<script type="text/javascript" src='../js/jquery.validate.min.js'></script>
<script type="text/javascript" src='../js/jquery.overlay.js'></script>
<script type="text/javascript" src='../js/hideShowPassword.min.js'></script>
<style>
.additem { width:420px; display:none; padding:50px;color:white; }
#accform{width:420px;}
#accform div{ width:180px; left:150px;margin-right:30px;text-align:right; }
#accform input{ padding:2px 0 2px 0; width:180px; }
</style>
<body id="framebody" class="maintenancebody">
<div id="mainbody" class="maindiv">
    <div class="navi"><span id="a_colore">Network Manager</span></div>
    <div id="statusdiv"></div>
	<form action="" method="get" id="Formvalidate">
		<fieldset>
            <div webtip="Enable TR-069">
                <div class="rebootitem"><span id="a_openacs">Enable TR-069</span> :</div>
                <input name="openacs" type="checkbox" id="openacs" /><span id="a_openacsyes">Yes</span>
                <span class="rebootspan"></span>
            </div>
            <div webtip="ACS URL">
                <div class="rebootitem"><span id="a_acsurl">ACS URL</span> :</div>
                <input name="acsurl" type="text" id="acsurl" />
                <!--span class="rebootspan"></span-->
            </div>
            <div webtip="" class="coloreversion">
                <div class="noreboot"><span id="a_netenable">Enable Network Manager Function</span> :</div>
                <input name="netenable" type="checkbox" id="netenable" /><span id="a_netenableyes">Yes</span>
            </div>
            <div webtip="" class="coloreversion">
                <div class="noreboot"><span id="a_username">Username</span> :</div>
                <input name="username" type="text" id="username" />
            </div>
            <div webtip="" style="width:700px;" class="coloreversion">
                <div class="noreboot"><span id="a_password">Password</span> :</div>
                <input name="password" type="password" id="password" autocomplete="off" />
            </div>
            <div webtip="" style="width:700px;" class="coloreversion">
                <div class="noreboot"></div>
                <button id="changepwd" type="button" rel="#change_pwd" class="widebtn overlayAcc">Change Password</button>
                <div class="additem" id="change_pwd">
                    <h3 id="formtip" class="formtip" style="background:transparent;margin-left:100px;"></h3>
                    <div id="accform">
                        <div><span id="a_chguname">Username</span> :</div>
                        <input id="chguname" type="text" value="" /><br/><br/>
                        <div><span id="a_chgpwd">New Password</span> :</div>
                        <input id="chgpwd" type="password" value="" autocomplete="off" /><br/><br/>
                        <div><span id="a_chgconfirmpwd">Confirm New Password</span> :</div>
                        <input id="chgconfirmpwd" type="password" value="" autocomplete="off" /><br/><br/><br/>
                        <button id="a_chgok" type="button" style="margin-left:210px;">OK</button>&nbsp;&nbsp;&nbsp;
                        <button id="a_chgno" type="button" class="close">Cancel</button>
                    </div>
                </div>
            </div>
            <div webtip="" class="coloreversion">
                <div class="noreboot"><span id="a_savepwd">Save Password</span> :</div>
                <input name="savepwd" type="checkbox" id="savepwd" /><span id="a_savepwdyes">Yes</span>
            </div>
            <div webtip="" class="coloreversion">
                <div class="noreboot"><span id="a_autologin">Auto Login</span> :</div>
                <input name="autologin" type="checkbox" id="autologin" /><span id="a_autologinyes">Yes</span>
            </div>
            <div webtip="ACS Username" class="normalversion">
                <div class="rebootitem"><span id="a_acsusername">ACS Username</span> :</div>
                <input name="acsusername" type="text" id="acsusername" /><!--span class="rebootspan"></span-->
            </div>
            <div webtip="ACS Password" class="normalversion">
                <div class="rebootitem"><span id="a_acspwd">ACS Password</span> :</div>
                <input name="acspwd" type="password" id="acspwd" autocomplete="off" /><!--span class="rebootspan"></span-->
            </div>
            <div webtip="Periodic Inform Enable">
                <div class="rebootitem"><span id="a_perialenable">Periodic Inform Enable</span> :</div>
                <input name="perialenable" type="checkbox" id="perialenable"><span id="a_perialenableyes">Yes</span>
                <!--span class="rebootspan"></span-->
            </div>
            <div webtip="Periodic Inform Interval">
                <div class="rebootitem"><span id="a_perialinterval">Periodic Inform Interval</span> :</div>
                <input name="perialinterval" type="text" id="perialinterval" /><!--span class="rebootspan"></span-->
            </div>
            <div webtip="Connection Request Username">
                <div class="rebootitem"><span id="a_conusername">Connection Request Username</span> :</div>
                <input name="conusername" type="text" id="conusername" /><!--span class="rebootspan"></span-->
            </div>
            <div webtip="Connection Request Password">
                <div class="rebootitem"><span id="a_conpwd">Connection Request Password</span> :</div>
                <input name="conpwd" type="password" id="conpwd" autocomplete="off" /><!--span class="rebootspan"></span-->
            </div>
            <div webtip="Connection Request Port">
                <div class="rebootitem"><span id="a_conport">Connection Request Port</span> :</div>
                <input name="conport" type="text" id="conport" /><!--span class="rebootspan"></span-->
            </div>
            <div webtip="CPE Cert File" style="width:680px;">
                <div class="rebootitem"><span id="a_cpecert">CPE Cert File</span> :</div>
                <textarea name="cpecert" id="cpecert" style="width:240px; padding:5px; height:100px;"></textarea><!--span class="rebootspan"></span-->
            </div>
            <div webtip="CPE Cert Key" style="width:680px;">
                <div class="rebootitem"><span id="a_cpekey">CPE Cert Key</span> :</div>
                <textarea name="cpekey" id="cpekey" style="width:240px; padding:5px; height:100px;"></textarea>
                <!--span class="rebootspan"></span-->
            </div>
        </fieldset>
        <div class="savediv">
            <button id="a_save" type="button" class="savebtn">Save</button>
            <button id="a_cancel" type="button" class="cancelbtn">Cancel</button>
        </div>
	</form>

</div>

<script type="text/javascript">
	var cookie_lang = $.cookie( "MyLanguage");
    if ( !cookie_lang ){
        cookie_lang = 'en';
	}
    if ( cookie_lang == 'zh' ){
        document.write("<script src='../js/jquery.validate.messages_cn.js'><\/script>");
	}
    document.write("<script src='../lang/" + cookie_lang + ".js'><\/script>");

</script>
<script type="text/javascript" src='../js/public.js'></script>
<script>
/* jQuery autoResize (textarea auto-resizer) */
(function(a){a.fn.autoResize=function(j){var b=a.extend({onResize:function(){},animate:true,animateDuration:150,animateCallback:function(){},extraSpace:20,limit:1000},j);this.filter('textarea').each(function(){var c=a(this).css({resize:'none','overflow-y':'hidden'}),k=c.height(),f=(function(){var l=['height','width','lineHeight','textDecoration','letterSpacing'],h={};a.each(l,function(d,e){h[e]=c.css(e)});return c.clone().removeAttr('id').removeAttr('name').css({position:'absolute',top:0,left:-9999}).css(h).attr('tabIndex','-1').insertBefore(c)})(),i=null,g=function(){f.height(0).val(a(this).val()).scrollTop(10000);var d=Math.max(f.scrollTop(),k)+b.extraSpace,e=a(this).add(f);$("#iframediv",parent.document.body).css('width','100%').css('height',$("body").height() + b.extraSpace);$(".footContent",parent.document.body).css('top',$("body").height() + b.extraSpace + 160);if(i===d){return}i=d;if(d>=b.limit){a(this).css('overflow-y','');return}b.onResize.call(this);b.animate&&c.css('display')==='block'?e.stop().animate({height:d},b.animateDuration,b.animateCallback):e.height(d)};c.unbind('.dynSiz').bind('keyup.dynSiz',g).bind('keydown.dynSiz',g).bind('change.dynSiz',g)});return this}})(jQuery);
</script>
<script type="text/javascript">
var oldpwd;
var loginsuc = 0;
var triggersacc;
var req_items = new Array;
req_items.push(
    new ReqItem("openacs", "1409", ""),
    new ReqItem("acsurl", "4503", ""),
    new ReqItem("acsusername", "4504", ""),
    new ReqItem("acspwd", "4505", ""),
    new ReqItem("perialenable", "4506", ""),
    new ReqItem("perialinterval", "4507", ""),
    new ReqItem("conusername", "4511", ""),
    new ReqItem("conpwd", "4512", ""),
    //new ReqItem("conauthmode", "4519", ""),
    new ReqItem("conport", "4518", ""),
    new ReqItem("cpecert", "8220", ""),
    new ReqItem("cpekey", "8221", "")
);

$(function(){
    setInitState();
    cb_get(req_items);
    show_or_hide();
    pageEventActions();
});

function show_or_hide()
{
    var colore = $('#existcolore',parent.document.body).val();
    if( colore == 1 )
    {
        $(".coloreversion").show();
        $(".normalversion").hide();
        cb_get_colore();
    }else
    {
        $(".coloreversion").hide();
        $(".normalversion").show();
    }
}
function get_item_suc_callback(){
    
}
function setInitState(){
    translate_tr069();
    $("#Formvalidate").validate({
		rules: {
		    acsurl:"url",
			perialinterval: {digits: true, range: [1, 4294967295], required: true },
            conusername: { maxlength: 64 },
            conpwd: { maxlength: 64 },
            conport: { digits:true, range:[0, 65535] }
        },
		errorElement: "em",
		success: function(label) { label.text(" "); }
    });
    
    $('#cpecert,#cpekey').autoResize({
        onResize : function() {
            $(this).css({opacity:0.8});
        },
        animateCallback : function() {
            $(this).css({opacity:1});
        },
        animateDuration : 300,
        extraSpace : 100,
        limit: 250
    });
}
function translate_tr069(){
    $("#a_colore").text(a_16034);
    $("#a_openacs").text(a_16360);
    $("#a_netenable").text(a_16361);
    $("#a_openacsyes, #a_netenableyes, #a_savepwdyes, #a_autologinyes").text(a_5);
    $("#a_username, #a_chguname").text(a_9206);
    $("#a_password").text(a_595);
    $("#a_chgpwd").text(a_6157);
    $("#a_chgconfirmpwd").text(a_16362);
    $("#changepwd").text(a_6295);
    $("#a_chgok").text(a_2);
    $("#a_chgno, #a_cancel").text(a_3);
    $("#a_savepwd").text(a_16363);
    $("#a_autologin").text(a_16364);
    
    $("#a_acsurl").text(a_16365);
    $("#a_acsusername").text(a_16366);
    $("#a_acspwd").text(a_16367);
    $("#a_perialenable").text(a_16368);
    $("#a_perialenableyes").text(a_5);
    $("#a_perialinterval").text(a_16369);
    $("#a_conusername").text(a_16370);
    $("#a_conpwd").text(a_16371);
    $("#a_conport").text(a_16372);
    $("#a_cpecert").text(a_16373);
    $("#a_cpekey").text(a_16374);
    $("#a_save").text(a_17);
}

function cb_get_colore(){
    var urihead = "action=getcolore&region=maintenance";
    urihead += "&time=" + new Date().getTime();
    $.ajax ({
        type: 'get',
        url:'/manager',
        data:urihead,
        dataType:'text',
        success:function(data) {
            cb_get_colore_suc(data);
        },
        error:function(xmlHttpRequest, errorThrown) {
            view_message("Get Error", MSG_ALERT);
        }
    });
}

function cb_get_colore_suc(data)
{
    var msgs = res_parse_rawtext(data);
    if(msgs.headers['enable'] == 1)
        $('#netenable').attr('checked', true);
    else
        $('#netenable').attr('checked', false);
       
    $("#username").val( msgs.headers['username'] );
    oldpwd = msgs.headers['password'];
    $("#password").val( oldpwd );
    loginsuc = msgs.headers['loginsuc'];
    if(msgs.headers['save-password'] == 1)
        $('#savepwd').attr('checked', true);
    else
        $('#savepwd').attr('checked', false);
        
    if(msgs.headers['auto-login'] == 1)
        $('#autologin').attr('checked', true);
    else
        $('#autologin').attr('checked', false);
    cb_colore_change();

}

function cb_colore_change() {
    if ($('#netenable').prop("checked") == true) {
        $('#a_username, #a_password, #a_savepwd, #a_autologin, #a_savepwdyes, #a_autologinyes').attr('disabled', false).css('color','');
        $('#username, #password, #savepwd, #changepwd, #autologin').attr('disabled', false);
        $('#changepwd').removeClass('widebtndisabled');
        if( loginsuc == 0 )
        {
            $('#changepwd').attr('disabled', true);
            $('#changepwd').addClass('widebtndisabled');
        }
    }
    else{
        $('#a_username, #a_password, #a_savepwd, #a_autologin, #a_savepwdyes, #a_autologinyes').attr('disabled', true).css('color','#BFBFBF');
        $('#username, #password, #changepwd, #savepwd, #autologin').attr('disabled', true);
        $('#changepwd').addClass('widebtndisabled');
    }
}

function cb_put_colore(){
    var enabled = 0;
    var savepwd = 0;
    var autologin = 0;
    if( $('#netenable').prop("checked") == true)
        enabled = 1;
    if( $('#savepwd').prop("checked") == true)
        savepwd = 1;
    if( $('#autologin').prop("checked") == true)
        autologin = 1;
    var urihead = "action=putcolore&region=maintenance&enable=" + enabled + "&username=" + $("#username").val() + "&pwd=" + $("#password").val() + "&savepwd=" + savepwd + "&autologin=" + autologin;
    urihead += "&time=" + new Date().getTime();
    $.ajax ({
        type: 'get',
        url:'/manager',
        data:urihead,
        dataType:'text',
        success:function(data) {
            cb_put_suc(data,"");
        },
        error:function(xmlHttpRequest, errorThrown) {
            view_message("Get Error", MSG_ALERT);
        }
    });
}

function cb_change_pwd_ok()
{
    var urihead = "action=changepwd&region=maintenance&uname=" + $("#chguname").val() + "&oldpwd=" + oldpwd + "&pwd=" + $("#chgpwd").val();
    urihead += "&time=" + new Date().getTime();
    $.ajax ({
        type: 'get',
        url:'/manager',
        data:urihead,
        dataType:'text',
        success:function(data) {
            setTimeout("cb_change_pwd_response()", 2000);
        },
        error:function(xmlHttpRequest, errorThrown) {
            view_message("Get Error", MSG_ALERT);
        }
    });
}

function cb_change_pwd_response()
{
    var urihead = "action=chgcolorepwdrsps&region=maintenance";
    urihead += "&time=" + new Date().getTime();
    $.ajax ({
        type: 'get',
        url:'/manager',
        data:urihead,
        dataType:'text',
        success:function(data) {
            cb_change_pwd_response_suc(data);
        },
        error:function(xmlHttpRequest, errorThrown) {
            view_message("Get Error", MSG_ALERT);
        }
    });
}

function cb_change_pwd_response_suc(data)
{
    var msgs = res_parse_rawtext(data);
    if( msgs.headers['chgcolorepwdrsps'] == 0 )
    {
        triggersacc.overlay().close();
        var urihead = "action=putcolore&region=maintenance&username=" + $("#chguname").val() + "&pwd=" + $("#chgpwd").val();
        urihead += "&time=" + new Date().getTime();
        $.ajax ({
            type: 'get',
            url:'/manager',
            data:urihead,
            dataType:'text',
            success:function(data) {
                cb_put_suc(data,"");
            },
            error:function(xmlHttpRequest, errorThrown) {
                view_message("Save Error", MSG_ALERT);
            }
        });
    }else
    {
        $(".errortip").remove();
        var $errormsg = $("<span style='Color:red' class='errortip'>" + a_chgerror + "</span>");
        $errormsg.appendTo($("#formtip"));
    }
}

function pageEventActions(){
    triggersacc = $("button.overlayAcc").overlay({ 	 
		expose: { color: '#333', loadSpeed: 200, opacity: 0.9 }, 	 
		closeOnClick: false,
        onBeforeLoad: function(event){
            $("#chguname, #chgpwd, #chgconfirmpwd").val("");
            $(".errortip").remove();
        }
	});
    
    $("#acspwd, #conpwd").hideShowPassword({
        innerToggle: true
    });
    
	$("#a_chgok").click(function(e) {
        if($("#chguname").val() == ""){
            $(".errortip").remove();
            var $errormsg = $("<span style='Color:red' class='errortip'>" + a_16465 + "</span>");
            $errormsg.appendTo($("#formtip"));
            return e.preventDefault();
        }else if($("#chgpwd").val() == "" || $("#chgconfirmpwd").val() == ""){
            $(".errortip").remove();
            var $errormsg = $("<span style='Color:red' class='errortip'>" + a_16466 + "</span>");
            $errormsg.appendTo($("#formtip"));
            return e.preventDefault();
        }else if($("#chgpwd").val() != $("#chgconfirmpwd").val() ){
            $(".errortip").remove();
            var $errormsg = $("<span style='Color:red' class='errortip'>" + a_16467 + "</span>");
            $errormsg.appendTo($("#formtip"));
            return e.preventDefault();
        }else{
            $(".errortip").remove();
            var $errormsg = $("<span style='Color:red' class='errortip'>" + a_16468 + "</span>");
            $errormsg.appendTo($("#formtip"));
            cb_change_pwd_ok();
        }    
    });
    
    $("#netenable").change(function(){
        cb_colore_change();
    });
    
    $("#a_save").click(function(){
        if( !$("#Formvalidate").valid() ){
            view_message(a_16442,MSG_FAIL);
            return false;
        }
        cb_put(req_items, "", 0);
        var colore = $('#existcolore',parent.document.body).val();
        if( colore == 1 )
            cb_put_colore();
    });
}

</script>

</body>

</html>
