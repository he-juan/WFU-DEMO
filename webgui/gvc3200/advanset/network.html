<!-- saved from url=(0022)http://internet.e-mail -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<link href='../css/pageframe.css' type='text/css' rel='stylesheet'>
<script type='text/javascript' src='../js/jquery.tools.min.js'></script>	
<script type="text/javascript" src='../js/jquery.cookie.js'></script>
<script type="text/javascript" src='../js/jquery.validate.min.js'></script>
<script type="text/javascript" src='../js/jquery.stylish-select.min.js'></script>
<script type="text/javascript" src='../js/ajaxupload.3.5.js'></script>
<script type="text/javascript" src='../js/jquery.prompt.js'></script>
<script type="text/javascript" src='../js/hideShowPassword.min.js'></script>
<style>
body{}
.dotline { width:600px; margin-left:50px;}
.staticip input[type="text"]{width:50px;}
.staticip input{*width:50px;}
fieldset .copyright{width: 70%; margin: 20px 15% 0 15%;}
fieldset .copyright span{display: inline-block; text-align: right; width: 100%; color: #bbb; font-size: 12px;}
</style>
<body id="framebody">
<div class="tooltip"></div>

<div id="mainbody" class="maindiv">
    <div class="navi"><span id="a_basic">Basic Settings</span></div>
    <form action="" method="get" id="Formvalidate">
        <fieldset>
            <div webtip="Preferred Internet Protocol">
                <div class="noreboot"><span id="a_protocoltype">Preferred Internet Protocol</span> :</div>
                <select id='protocoltype'>
                    <option value='0'>Both (Prefer IPv6)</option>
                    <option value='1'>Both (Prefer IPv4)</option>
                    <option value='2'>Ipv4 Only</option>
                    <option value='3'>Ipv6 Only</option>
                </select>
                <!--
                <input name="protocoltype" value="0" checked="checked" type="radio" id="prefpro_ipv4"><span>IPv4</span>
                <input name="protocoltype" value="1" type="radio" id="prefpro_ipv6" style='margin-left:16px;'><span>IPv6</span>
                -->
            </div>
            <div class="titlediv">
                <div class="titleboot"><span id="a_basicsettitle">Basic Settings</span></div>
            </div>
            <div webtip="Address Type">
                <div class="noreboot"><span id="a_networktype">Address Type</span> :</div>
                <select id="networktype" name="networktype">
                    <option value="0">DHCP</option>
                    <option value="1">Static IP</option>
                    <option value="2">PPPOE</option>
                </select>
            </div>
            <div webtip="DHCP VLAN Override" style="width:690px;" class="dhcp">
                <div class="noreboot"><span id="a_dhcpvlan">DHCP VLAN Override</span> :</div>
                <select name="dhcpvlan" id="dhcpvlan">
                    <option value="0">Disabled</option>     
                    <option value="1">DHCP Option 132 and DHCP option 133</option> 
                    <option value="2">Encapsulated in DHCP Option 43</option>          
                </select>
                <!--<div style="width: 290px;padding-left: 0;margin-top: 0 !important;">
                    <input name="dhcpvlan" value="0" checked="checked" type="radio" id="vlandisable"><span id="a_vlandisable">Disabled</span><br/>
                    <input name="dhcpvlan" value="1" type="radio" id="vlanoption132"><span id="a_vlanoption132">DHCP Option 132 and DHCP option 133</span><br/>
                    <input name="dhcpvlan" value="2" type="radio" id="vlanoption43"><span id="a_vlanoption43">Encapsulated in DHCP Option 43</span>
                </div>-->
            </div>
            <div webtip="Host name" class="dhcp">
                <div class="noreboot"><span id="a_dhcpop12">DHCP option 12</span> :</div>
                <input id="dhcpop12" name="dhcpop12" type="text" />
            </div>
            <div webtip="" style="display:none;">
                <div class="noreboot"><span id="a_dhcpop15">DHCP option 15</span> :</div>
                <input id="dhcpop15" name="dhcpop15" type="text" />
            </div>
            <div webtip="Vendor Class ID" class="dhcp">
                <div class="noreboot"><span id="a_dhcpop60">DHCP option 60</span> :</div>
                <input id="dhcpop60" name="dhcpop60" type="text" />
            </div>
            <div webtip="Vendor ID Vendor-Specific" style="display:none;">
                <div class="noreboot"><span id="a_dhcpop125">DHCP option 125</span> :</div>
                <input id="dhcpop125" name="dhcpop125" type="text" />
            </div>
            <div webtip="DHCP Option 120 Override SIP Server" class="dhcp">
                <div class="rebootitem"><span id="a_dhcp120">DHCP Option 120 Override SIP Server</span> :</div>
                <input name="dhcp120" type="checkbox" id="dhcp120" checked="checked"><span id="a_dhcp120yes">Yes</span>
                <span class="rebootspan"></span>
            </div>
            <div webtip="IP Address" class="staticip">
                <div class="noreboot"><span id="a_ipaddr">IP Address</span> :</div>
                <input size="3" maxlength="3" name="ipaddress" type="text" id="ipaddr1">
                .<input size="3" maxlength="3" name="ipaddress" type="text" id="ipaddr2">
                .<input size="3" maxlength="3" name="ipaddress" type="text" id="ipaddr3">
                .<input size="3" maxlength="3" name="ipaddress" type="text" id="ipaddr4">
            </div>
            <div webtip="Subnet Mask" class="staticip">
                <div class="noreboot"><span id="a_subnetmask">Subnet Mask</span> :</div>
                <input size="3" maxlength="3" name="submask" type="text" id="mask1">
                .<input size="3" maxlength="3" name="submask" type="text" id="mask2">
                .<input size="3" maxlength="3" name="submask" type="text" id="mask3">
                .<input size="3" maxlength="3" name="submask" type="text" id="mask4">
            </div>
            <div webtip="Default Gateway" class="staticip">
                <div class="noreboot"><span id="a_gateway">Default Gateway</span> :</div>
                <input size="3" maxlength="3" name="dftgateway" type="text" id="gateway1">
                .<input size="3" maxlength="3" name="dftgateway" type="text" id="gateway2">
                .<input size="3" maxlength="3" name="dftgateway" type="text" id="gateway3">
                .<input size="3" maxlength="3" name="dftgateway" type="text" id="gateway4">
            </div>
            <div webtip="DNS Server 1" class="staticip">
                <div class="noreboot"><span id="a_dnsserver">DNS server 1</span> :</div>
                <input size="3" maxlength="3" name="dnsserver1" type="text" id="prednsser1">
                .<input size="3" maxlength="3" name="dnsserver1" type="text" id="prednsser2">
                .<input size="3" maxlength="3" name="dnsserver1" type="text" id="prednsser3">
                .<input size="3" maxlength="3" name="dnsserver1" type="text" id="prednsser4">
            </div>
            <div webtip="DNS Server 2" class="staticip">
                <div class="noreboot"><span id="a_alerdnsser">DNS server 2</span> :</div>
                <input size="3" maxlength="3" name="dnsserver2" type="text" id="alerdnsser1">
                .<input size="3" maxlength="3" name="dnsserver2" type="text" id="alerdnsser2">
                .<input size="3" maxlength="3" name="dnsserver2" type="text" id="alerdnsser3">
                .<input size="3" maxlength="3" name="dnsserver2" type="text" id="alerdnsser4">
            </div>
            <div webtip="PPPoE Account ID" class="pppoe">
                <div class="rebootitem"><span id="a_pppacc">PPPoE Account ID</span> :</div>
                <input name="ppoeaccount" type="text" id="ppoeaccount" />
            </div>
            <div webtip="PPPoE Password" class="pppoe">
                <div class="rebootitem"><span id="a_pppoepwd">PPPoE Password</span> :</div>
                <input name="ppoepassword" type="password" id="ppoepassword" autocomplete="off" />
            </div>
            <div webtip="PPPoE Service Name" style="display:none;">
                <div class="rebootitem"><span id="a_pppoesn">PPPoE Service Name</span> :</div>
                <input id="pppoeservice" name="pppoeservice" type="text" />
            </div>
            <div class="titlediv">
                <div class="titleboot"><span id="a_802xmode">802.1x Mode</span></div>
            </div>
            <div webtip="802.1x Mode">
                <div class="rebootitem"><span id="a_802mode">802.1x Mode</span> :</div>
                <select name="xmode" id="xmode">
                    <option value="0">Close</option> 
                    <option value="1">EAP-MD5</option>     
                    <option value="2">EAP-TLS</option>
                    <option value="3">EAP-PEAP</option>           
                </select>
            </div>
            <div id="identitydiv" webtip="802.1x Identity">
                <div class="rebootitem"><span id="a_identity">802.1x Identity</span> :</div>
                <input name="identity" type="text" id="identity" />
            </div>
            <div id="md5pasdiv" webtip="802.1x Secret">
                <div class="rebootitem"><span id="a_md5pas">802.1x Secret</span> :</div>
                <input name="md5pas" type="password" id="md5pas" autocomplete="off" />
            </div>
            <div webtip="CA Certificate" class="uploaddiv" id="uploaddivpart2">
                <div class="rebootitem"><span id="a_802ca">CA Certificate</span> :</div>
                <button id="a_uploadca" type="button" value="Upload">Upload</button>
            </div>
            <div webtip="Client Certificate" class="uploaddiv" id="uploaddivpart1">
                <div class="rebootitem"><span id="a_802client">Client Certificate</span> :</div>
                <button id="a_uploadclient" type="button" value="Upload">Upload</button>
            </div>
            <div webtip="Private Key" class="uploaddiv" style="padding-bottom:10px;" id="uploaddivpart3">
                <div class="rebootitem"><span id="a_privatekey">Private Key</span> :</div>
                <button id="a_uploadprivkey" type="button" value="Upload">Upload</button>
            </div>
            <div class="titlediv g_user">
                <div class="titleboot"><span id="a_qos">QoS</span></div>
            </div>
            <div webtip="Enable LLDP" class="g_user">
                <div class="noreboot"><span id="a_enablelldp">Enable LLDP</span> :</div>
                <input name="enablelldp" type="checkbox" id="enablelldp"><span id="a_enablelldpyes">Yes</span>
            </div>
            <div id="layer3qos" class="g_user" webtip="Layer 3 QoS" style="display:none">
                <div class="noreboot"><span id="a_layer3qos">Layer 3 QoS</span> :</div>
                <input name="layer3qos" type="text" id="layer3qos" value="0" />
            </div>
            <div class="layer3 g_user" webtip="Layer 3 QoS for SIP">
                <div class="noreboot"><span id="a_layer3qossip">Layer 3 QoS for SIP</span> :</div>
                <input name="layer3qossip" type="text" id="layer3qossip" />
            </div>
            <div class="layer3 g_user" webtip="Layer 3 QoS for Audio">
                <div class="noreboot"><span id="a_layer3qosaudio">Layer 3 QoS for Audio</span> :</div>
                <input name="layer3qosaudio" type="text" id="layer3qosaudio" />
            </div>
            <div class="layer3video g_user" webtip="Layer 3 QoS for Video">
                <div class="noreboot"><span id="a_layer3qosvideo">Layer 3 QoS for Video</span> :</div>
                <input name="layer3qosvideo" type="text" id="layer3qosvideo" />
            </div>
            <div id="layer2tag" class="g_user" webtip="Layer 2 QoS 802.1Q/VLAN Tag">
                <div class="rebootitem"><span id="a_layer2qos">Layer 2 QoS 802.1Q/VLAN Tag</span> :</div>
                <input name="layer2qos" type="text" id="layer2qos" value="0" />
            </div>
            <div id="layer2pri" class="g_user" webtip="Layer 2 QoS 802.1p Priority Value">
                <div class="rebootitem"><span id="a_layer2qospv">Layer 2 QoS 802.1p Priority Value</span> :</div>
                <input name="layer2qospv" type="text" id="layer2qospv" value="0" />
            </div>
            <div class="titlediv">
                <div class="titleboot"><span id="a_proxy">Proxy</span></div>
            </div>
            <div webtip="HTTP/HTTPS Proxy Hostname">
                <div class="noreboot"><span id="a_proxyhttp">HTTP/HTTPS Proxy Hostname</span> :</div>
                <input name="proxyhttpurl" type="text" id="proxyhttpurl" />
            </div>
            <div webtip="HTTP/HTTPS Proxy Port">
                <div class="noreboot"><span id="a_proxyport">HTTP/HTTPS Proxy Port</span> :</div>
                <input name="proxyhttpport" type="text" id="proxyhttpport" />
            </div>
            <div webtip="Apply to Other Protocol" style="display:none;">
                <div class="noreboot"></div>
                <input name="applyall" type="checkbox" id="applyall"><span id="a_applyall">Apply to Other Protocol</span>
            </div>
            <div webtip="https proxy" style="display:none">
                <div class="noreboot"><span id="a_proxyhttps">HTTPS Proxy</span> :</div>
                <input name="proxyhttps" type="text" id="proxyhttps" />
            </div>
            <div webtip="FTP Proxy" style="display:none;">
                <div class="noreboot"><span id="a_proxyftp">FTP Proxy</span> :</div>
                <input name="proxyftp" type="text" id="proxyftp" />
            </div>
            <div webtip="Bypass Proxy For">
                <div class="noreboot"><span id="a_noproxy">Bypass Proxy For</span> :</div>
                <input name="noproxy" type="text" id="noproxy" />
            </div>
            <div class="titlediv">
                <div class="titleboot"><span id="a_advsettitle">Advanced Settings</span></div>
            </div>
            <div webtip="Alternate DNS Server">
                <div class="rebootitem"><span id="a_relprednsser">Alternate DNS Server</span> :</div>
                <input size="3" maxlength="3" name="altserver" type="text" id="relprednsser1" style="width:40px;">
                .<input size="3" maxlength="3" name="altserver" type="text" id="relprednsser2" style="width:40px;">
                .<input size="3" maxlength="3" name="altserver" type="text" id="relprednsser3" style="width:40px;">
                .<input size="3" maxlength="3" name="altserver" type="text" id="relprednsser4" style="width:40px;">
            </div>
            <div webtip="Second Alternate DNS Server">
                <div class="rebootitem"><span id="a_2relprednsser">2nd Alternate DNS Server</span> :</div>
                <input size="3" maxlength="3" name="secaltserver" type="text" id="secrelprednsser1" style="width:40px;">
                .<input size="3" maxlength="3" name="secaltserver" type="text" id="secrelprednsser2" style="width:40px;">
                .<input size="3" maxlength="3" name="secaltserver" type="text" id="secrelprednsser3" style="width:40px;">
                .<input size="3" maxlength="3" name="secaltserver" type="text" id="secrelprednsser4" style="width:40px;">
            </div>
            <div webtip="HTTP/HTTPS User Agent">
                <div class="rebootitem"><span id="a_useragent">HTTP/HTTPS User Agent</span> :</div>
                <input name="useragent" type="text" id="useragent" value='' /><em></em>
            </div>
            <div webtip="SIP User Agent">
                <div class="rebootitem"><span id="a_sipuseragent">SIP User Agent</span> :</div>
                <input name="sipuseragent" type="text" id="sipuseragent" value='' /><em></em>
            </div>
            <div webtip="Frame Rate Compensation Certificate" style="display:none;">
                <div class="rebootitem"><span id="a_frameca">Frame Rate Compensation Certificate</span> :</div>
                <button id="a_uploadframe" type="button" value="Upload">Upload</button>
            </div>
            <div webtip="Media Address" class="uploadframediv" style="display:none;">
                <div class="rebootitem"><span id="a_mediaaddr">Media Address</span> :</div>
                <input name="mediaaddr" type="text" id="mediaaddr" value='' />
            </div>
            <div webtip="Frame Loss Compensation" class="uploadframediv" style="display:none;">
                <div class="noreboot"><span id="a_frameloss">Frame Loss Compensation</span> :</div>
                <input name="frameloss" type="checkbox" id="frameloss"><span id="a_framelossyes">Yes</span>
            </div>
            <div class="titlediv">
                <div class="titleboot"><span id="a_ipv6">IPv6</span></div>
            </div>
            <div webtip="IPv6 Address">
                <div class="rebootitem"><span id="a_ipv6addr">IPv6 Address</span> :</div>
                <select name="ipv6addr" id="ipv6addr">
                    <option value="0">Auto-configured</option>
                    <option value="1">Statically configured</option>
                </select>
            </div>
            <div webtip="Static IPv6 Address" class='ipv6staticitem'>
                <div class="noreboot"><span id="a_staticipv6addr">Static IPv6 Address</span> :</div>
                <input name="staticipv6addr" type="text" id="staticipv6addr" />
            </div>
            <div webtip="IPv6 Prefix length" class='ipv6staticitem'>
                <div class="noreboot"><span id="a_ipv6prefixlen">IPv6 Prefix length</span> :</div>
                <input name="ipv6prefixlen" type="text" id="ipv6prefixlen" />
            </div>
            <div webtip="IPv6 DNS Server 1" class='ipv6staticitem'>
                <div class="noreboot"><span id="a_ipv6dns1">DNS Server 1</span> :</div>
                <input name="ipv6dns1" type="text" id="ipv6dns1" />
            </div>
            <div webtip="IPv6 DNS Server 2" class='ipv6staticitem'>
                <div class="noreboot"><span id="a_ipv6dns2">DNS Server 2</span> :</div>
                <input name="ipv6dns2" type="text" id="ipv6dns2" />
            </div>
            <div webtip="Preferred DNS Server">
                <div class="noreboot"><span id="a_prefdnsserver">Preferred DNS Server</span> :</div>
                <input name="prefdnsserver" type="text" id="prefdnsserver" />
            </div>
            
            <div class="titlediv">
                <div class="titleboot"><span id="a_openvpnset">OpenVPN settings</span></div>
            </div>
            <div webtip="OpenVPN Enable">
                <div class="noreboot"><span id="a_vpnenable">OpenVPN Enable</span> :</div>
                <input name="vpnenable" type="checkbox" id="vpnenable" /><span id="a_vpnenableyes">Yes</span>
            </div>
            <div webtip="OpenVPN Server Address">
                <div class="noreboot"><span id="a_vpnsevaddr">OpenVPN Server Address</span> :</div>
                <input name="vpnsevaddr" type="text" id="vpnsevaddr" />
            </div>
            <div webtip="OpenVPN Port">
                <div class="noreboot"><span id="a_vpnport">OpenVPN Port</span> :</div>
                <input name="vpnport" type="text" id="vpnport" />
            </div>
            <div webtip="OpenVPN Transport">
                <div class="noreboot"><span id="a_vpntransport">OpenVPN Transport</span> :</div>
                <input name="vpntransport" value="0" checked="checked" type="radio" id="vpntransport0" radiogroup="vpntransport"><span>UDP</span>
                <input name="vpntransport" value="1" type="radio" id="vpntransport1" radiogroup="vpntransport"><span>TCP</span>
            </div>
            <div webtip="OpenVPN CA">
                <div class="noreboot"><span id="a_vpnca">OpenVPN® CA</span> :</div>
                <button id="vpncaupload" type="button" uploadtype="vpnca" filetype="crt">Upload</button>
                <button id="vpncadel" value="ca" type="button">Delete</button>
            </div>
            <div webtip="OpenVPN Client Certificate">
                <div class="noreboot"><span id="a_vpncert">OpenVPN Certificate</span> :</div>
                <button id="vpncertupload" type="button" uploadtype="vpncert" filetype="crt">Upload</button>
                <button id="vpncertdel" value="cert" type="button">Delete</button>
            </div>
            <div webtip="OpenVPN Client Key">
                <div class="noreboot"><span id="a_vpnkey">OpenVPN Client Key</span> :</div>
                <button id="vpnkeyupload" type="button" uploadtype="vpnkey" filetype="key">Upload</button>
                <button id="vpnkeydel" value="key" type="button">Delete</button>
            </div>
            <div webtip="OpenVPN Cipher Method">
                <div class="noreboot"><span id="a_vpncipher">OpenVPN Cipher Method</span> :</div>
                <select id="vpncipher" name="vpncipher">
                    <option value="0">Blowfish</option>
                    <option value="1">AES-128</option>
                    <option value="2">AES-256</option>
                    <option value="3">Triple-DES</option>
                </select>
            </div>
            <div webtip="OpenVPN Username">
                <div class="noreboot"><span id="a_vpnusername">OpenVPN Username</span> :</div>
                <input name="vpnusername" type="text" id="vpnusername" />
            </div>
            <div webtip="OpenVPN Password">
                <div class="noreboot"><span id="a_vpnpwd">OpenVPN Password</span> :</div>
                <input name="vpnpwd" type="text" id="vpnpwd" />
            </div>
            <div class="copyright">
                <span>© 2002-2014 OpenVPN Technologies, Inc.</span>
                <span>OpenVPN is a registered trademark of OpenVPN Technologies, Inc.</span>
            </div>
        </fieldset>
        <div class="savediv">
            <div id="statusdiv"></div>
            <button id="a_save" type="button" class="savebtn">Save</button>
            <button id="a_cancel" type="button" class="cancelbtn">Cancel</button>
        </div>
    </form>
</div>
<input name="proxyhttp" type="text" id="proxyhttp" style="display:none" />
<input name="openlldp" type="text" id="openlldp" style="display:none" value="" />
<script type="text/javascript">
	var cookie_lang = $.cookie( "MyLanguage");
    var version = $.cookie("ver");
    if ( !cookie_lang ){
        cookie_lang = 'en';
	}
    if ( cookie_lang == 'zh' ){
        document.write("<script src='../js/jquery.validate.messages_cn.js'><\/script>");
	}
    if(!version)
        version = new Date().getTime();
    document.write("<script src='../js/public.js?ver=" + version + "'><\/script>");
    document.write("<script src='../lang/" + cookie_lang + ".js?ver=" + version + "'><\/script>");

</script>
<script type="text/javascript">
var req_items = new Array;
req_items.push(
    new ReqItem("protocoltype", "1415", ""),
    new ReqItem("networktype", "8", ""),
    new ReqItem("ppoeaccount", "82", ""),
    new ReqItem("ppoepassword", "83", ""),
    new ReqItem("pppoeservice", "269", ""),
    new ReqItem("dhcpvlan", "8300", ""),
    new ReqItem("dhcpop12", "146", ""),
    new ReqItem("dhcpop15", "147", ""),
    new ReqItem("dhcpop60", "148", ""),
    new ReqItem("dhcpop125", "dhcpop125", ""),
    new ReqItem("dhcp120", "1411", ""),
    new ReqItem("ipaddr1", "9", ""),
    new ReqItem("ipaddr2", "10", ""),
    new ReqItem("ipaddr3", "11", ""),
    new ReqItem("ipaddr4", "12", ""),
    new ReqItem("mask1", "13", ""),
    new ReqItem("mask2", "14", ""),
    new ReqItem("mask3", "15", ""),
    new ReqItem("mask4", "16", ""),
    new ReqItem("gateway1", "17", ""),
    new ReqItem("gateway2", "18", ""),
    new ReqItem("gateway3", "19", ""),
    new ReqItem("gateway4", "20", ""),
    new ReqItem("prednsser1", "21", ""),
    new ReqItem("prednsser2", "22", ""),
    new ReqItem("prednsser3", "23", ""),
    new ReqItem("prednsser4", "24", ""),
    new ReqItem("alerdnsser1", "25", ""),
    new ReqItem("alerdnsser2", "26", ""),
    new ReqItem("alerdnsser3", "27", ""),
    new ReqItem("alerdnsser4", "28", ""),
    new ReqItem("relprednsser1", "92", ""),
    new ReqItem("relprednsser2", "93", ""),
    new ReqItem("relprednsser3", "94", ""),
    new ReqItem("relprednsser4", "95", ""),
    new ReqItem("secrelprednsser1", "5026", ""),
    new ReqItem("secrelprednsser2", "5027", ""),
    new ReqItem("secrelprednsser3", "5028", ""),
    new ReqItem("secrelprednsser4", "5029", ""),
    new ReqItem("openlldp", "in_lldp", ""),
    new ReqItem("enablelldp", "1684", ""),
    new ReqItem("useragent", "1541", ""),
    new ReqItem("sipuseragent", "26027", ""),
    new ReqItem("xmode", "7901", ""),
    new ReqItem("identity", "7902", ""),
    new ReqItem("md5pas", "7903", ""),
    //new ReqItem("layer3qos", "38", ""),
    new ReqItem("layer3qossip", "1558", ""),
    new ReqItem("layer3qosaudio", "1559", ""),
    new ReqItem("layer3qosvideo", "1560", ""),
    new ReqItem("layer2qos", "51", ""),
    new ReqItem("layer2qospv", "87", ""),
    new ReqItem("proxyhttp", "1552", ""),
    new ReqItem("applyall", "22045", ""),
    new ReqItem("proxyhttps", "1553", ""),
    new ReqItem("proxyftp", "22044", ""),
    new ReqItem("noproxy", "22011", ""),
    new ReqItem("mediaaddr", "media_address", ""),
    new ReqItem("frameloss", "enableFrameComp", ""),
    new ReqItem("ipv6addr", "1419", ""),
    new ReqItem("staticipv6addr", "1420", ""),
    new ReqItem("ipv6prefixlen", "1421", ""),
    new ReqItem("ipv6dns1", "1424", ""),
    new ReqItem("ipv6dns2", "1425", ""),
    new ReqItem("prefdnsserver", "1423", ""),
    new ReqItem("vpnenable", "7050", ""),
    new ReqItem("vpnsevaddr", "7051", ""),
    new ReqItem("vpnport", "7052", ""),
    new ReqItem("vpntransport", "2912", ""),
    new ReqItem("vpncipher", "8396", ""),
    new ReqItem("vpnusername", "8394", ""),
    new ReqItem("vpnpwd", "8395", "")
);
var default_ipv6static;
var default_ipv6prefix;

$(function(){   
    setInitState();
    cb_get(req_items);
    init_uploadca();
    init_uploadclient();
    init_uploadprivkey();
    init_openvpn();
    var mOEMID = $('#existcolore', window.parent.document).val();
    if(mOEMID == '54'){
        $("#a_mediaaddr").text(a_19317);
        $(".uploadframediv").show();
        //init_uploadframe();
    }
    $("input[type='file']").attr("title", "");
    pageEventActions();
});

function translate_page(){
    $("#a_networktype").text(a_4150);
    $("#a_dhcp120").text(a_16338);
    $("#networktype option:eq(0)").text(a_4124);
    $("#networktype option:eq(1)").text(a_4125);
    $("#networktype option:eq(2)").text(a_16183);
    $("#a_dnsserver").text(a_16184);
    $("#a_alerdnsser").text(a_16185);
    $("#a_pppacc").text(a_4156);
    $("#a_pppoepwd").text(a_4157);
    $("#a_pppoesn").text(a_16186);
    $("#a_dhcpvlan").text(a_19335);
    $("#dhcpvlan option:eq(0)").text(a_39);
    $("#dhcpvlan option:eq(1)").text(a_19333);
    $("#dhcpvlan option:eq(2)").text(a_19334);
    $("#a_dhcpop12").text(a_16187);
    $("#a_dhcpop15").text(a_16188);
    $("#a_dhcpop60").text(a_16189);
    $("#a_dhcpop125").text(a_16190);
    $("#a_staip").text(a_4125);
    $("#a_ipaddr").text(a_6650);
    $("#a_subnetmask").text(a_4127);
    $("#a_gateway").text(a_4129);
    $("#a_dnsserver").text(a_16184);
    //$("#a_pppenable").text(a_pppenable);
    //$("#a_pppenableyes").text(a_yes);
    $("#a_alerdnsser").text(a_16185);
    $("#a_relprednsser").text(a_16652);
    $("#a_2relprednsser").text(a_16192);
    $("#a_enablelldp").text(a_16193);
    $("#a_enablelldpyes, #a_dhcp120yes, #a_vpnenableyes, #a_framelossyes").text(a_5);
    $("#a_useragent").text(a_16194);
    $("#a_sipuseragent").text(a_19128);
    $("#a_802xmode, #a_802mode").text(a_4140);  
    $("#xmode option:eq(0)").text(a_32);
    $("#a_identity").text(a_16195);
    $("#a_md5pas").text(a_16196);
    $("#a_802ca").text(a_4391);
    $("#a_802client").text(a_4392);
    $("#a_uploadca, #a_uploadclient, #a_uploadprivkey, #a_uploadframe").text(a_16197);
    //$("#a_layer3qos").text(a_layer3qos);
    $("#a_layer3qossip").text(a_4275);
    $("#a_layer3qosaudio").text(a_4276);
    $("#a_layer3qosvideo").text(a_4277);
    $("#a_layer2qos").text(a_4138);
    $("#a_layer2qospv").text(a_4139);
    $("#a_proxy").text(a_16651);
    $("#a_proxyhttp").text(a_16198);
    $("#a_proxyport").text(a_16199);
    $("#a_noproxy").text(a_16200);
    $("#a_cancel").text(a_3);
    $("#a_save").text(a_17);
    $("#a_basicsettitle").text(a_16597);
    $("#a_advsettitle").text(a_4101);
    $("#a_privatekey").text(a_4394);
    $("#a_frameca").text(a_19211);
    $("#a_frameloss").text(a_4340);
    $("#a_protocoltype").text(a_19225);
    $("#protocoltype option:eq(0)").text(a_19390);
    $("#protocoltype option:eq(1)").text(a_19391);
    $("#protocoltype option:eq(2)").text(a_19392);
    $("#protocoltype option:eq(3)").text(a_19393);
    $("#a_ipv6addr").text(a_19226);
    $("#ipv6addr option:eq(0)").text(a_19230);
    $("#ipv6addr option:eq(1)").text(a_19231);
    $("#a_staticipv6addr").text(a_19232);
    $("#a_ipv6prefixlen").text(a_19233);
    $("#a_ipv6dns1").text(a_19227);
    $("#a_ipv6dns2").text(a_19228);
    $("#a_prefdnsserver").text(a_19229);
    $("#a_openvpnset").text(a_19274);
    $("#a_vpnenable").text(a_19265);
    $("#a_vpnsevaddr").text(a_19266);
    $("#a_vpnport").text(a_19267);
    $("#a_vpntransport").text(a_19268);
    $("#a_vpncert").text(a_19269);
    $("#a_vpnkey").text(a_19270);
    $("#a_vpncipher").text(a_19271);
    $("#a_vpnusername").text(a_19272);
    $("#a_vpnpwd").text(a_19273);
    $("#vpncaupload, #vpncertupload, #vpnkeyupload").text(a_4393);
    $("#vpncadel, #vpncertdel, #vpnkeydel").text(a_21);
}

function setInitState(){
    translate_page();
    $("#protocoltype, #networktype, #xmode, #ipv6addr, #dhcpvlan, #vpncipher").sSelect(); 
    //$("#xmode").sSelect({ddMaxHeight: '120px'}); 
    $("#Formvalidate").validate({
		rules: {
		    dhcpop12: { maxlength: 40 },
            dhcpop60: { maxlength: 40 },
            /*ipaddress: { required:true, digits: true, range:[0,255] },
            submask: { required:true, digits: true, range:[0,255] },
            dftgateway: { required:true, digits: true, range:[0,255] },
            dnsserver1: { required:true, digits: true, range:[0,255] },
            dnsserver2: { required:true, digits: true, range:[0,255] },*/
            //secaltserver: { digits: true, range:[0,255] },
            //altserver: { digits: true, range:[0,255] },
            //layer3qos: { digits: true, range:[0,63] },
            layer3qossip: { digits: true, range:[0,63] },
            layer3qosaudio: { digits: true, range:[0,63] },
            layer3qosvideo: { digits: true, range:[0,63] },
            layer2qos: { required:true, digits: true, range:[0,4094] },
            layer2qospv: { required:true, digits: true, range:[0,7] },
            proxyhttpport: { digits: true, range:[0,65535] },
            ipv6dns1: {ipv6: true},
            ipv6dns2: {ipv6: true},
            prefdnsserver: {ipv6: true}
        },

		errorElement: "em",
		success: function(label) { label.text(" ").addClass("success"); }
    });
    grant();
}
function grant() {
    var g_actype = $.cookie('type');
    if (typeof g_actype == "undefined" || !g_actype) {
        g_actype = "user";
    }
    
    if (g_actype.toLowerCase() == 'admin') {
        $('.layer3, #layer2tag, #layer2pri').show();
    } else {
        $(".g_user").hide();
    }
}
function cb_lldp_mode_change(open) {
    if( open && $("#openlldp").val() == "1") {
        $('.layer3 span, .layer3video span, #layer2tag span, #layer2pri span').removeClass("netfontcolor").addClass("grayfont");
        $('.layer3 input, .layer3video input, #layer2tag input, #layer2pri input').attr('disabled',true);
    }else{
        $('.layer3 span, .layer3video span, #layer2tag span, #layer2pri span').removeClass("grayfont").addClass("netfontcolor");
        $('.layer3 input, .layer3video input, #layer2tag input, #layer2pri input').attr('disabled',false);
    }
}
function get_item_suc_callback(){
    //cb_show_802_mode();
    var openlldp = $("#openlldp").val();
    if( openlldp == "1" ) 
        cb_lldp_mode_change(true);
    else
        cb_lldp_mode_change(false);
        
    var proxystr = $("#proxyhttp").val();
    var proxypos = proxystr.lastIndexOf(":");
    if( proxypos != -1 ) {
        $("#proxyhttpurl").val(proxystr.substring(0, proxypos));
        $("#proxyhttpport").val(proxystr.substring(proxypos+1));
    }else{
        $("#proxyhttpurl").val(proxystr);
    }
    cb_lldp_qos_check();
    cb_proxy_mode_change();
    set_ipv6_item_dis($("#ipv6addr").val());

    default_ipv6static = $("#staticipv6addr").val();
    default_ipv6prefix = $("#ipv6prefixlen").val();
}
/*function cb_mode_change(inited) {
	if($('#static').prop("checked") == true) {  
		if( !inited )
		    $("#ppptype").val("1");
        $('#staticipdiv').removeClass("grayfont").addClass("netfontcolor");
        $('#dhcpdiv, #pppoediv').removeClass("netfontcolor").addClass("grayfont");
		$('#dhcpop12, #dhcpop15, #dhcpop60, #dhcpop125, #ppoeaccount, #ppoepassword').attr('disabled',true);
		$('input[name=ipaddress], input[name=submask], input[name=dftgateway], input[name=dnsserver1], input[name=dnsserver2]').attr('disabled',false);
	}else if($('#pppoe').prop("checked") == true) {  
		if( !inited )
		    $("#ppptype").val("2");
        $('#pppoediv').removeClass("grayfont").addClass("netfontcolor");
        $('#staticipdiv, #dhcpdiv').removeClass("netfontcolor").addClass("grayfont");
		$('#ppoeaccount, #ppoepassword').attr('disabled',false);
		$('#dhcpop12, #dhcpop15, #dhcpop60, #dhcpop125, input[name=ipaddress], input[name=submask], input[name=dftgateway], input[name=dnsserver1], input[name=dnsserver2]').attr('disabled',true);
	}else {
		if( !inited )
		    $("#ppptype").val("0");
        $('#dhcpdiv').removeClass("grayfont").addClass("netfontcolor");
        $('#staticipdiv, #pppoediv').removeClass("netfontcolor").addClass("grayfont");
		$('#dhcpop12, #dhcpop15, #dhcpop60, #dhcpop125').attr('disabled',false);
		$('input[name=ipaddress], input[name=submask], input[name=dftgateway], input[name=dnsserver1], input[name=dnsserver2], #ppoeaccount, #ppoepassword').attr('disabled',true);
    }
}*/
function cb_mode_change(flag){
    switch(flag)
    {
        case 0:
            $(".staticip, .pppoe").hide();
            $(".dhcp").show();
            break;
        case 1:
            $(".staticip").show();
            $(".dhcp, .pppoe").hide();
            break;
        case 2:
            $(".dhcp, .staticip").hide();
            $(".pppoe").show();
            break;
        default:
            break;
    }
}

function cb_lldp_qos_check(){
    var vlanid, vlanqos, layer3qossip, layer3qosaudio, layer3qosvideo;
    var urihead = "action=get&var-0000=vlan_id&var-0001=vlan_qos&var-0002=:dscp2&var-0003=:dscp1&var-0004=:dscp7&time=" + new Date().getTime(); 
    $.ajax({
        type: 'get',
        url:'/manager',
        data:urihead,
        dataType:'text',
        async: false,
        success:function(data) {
            var msgs = res_parse_rawtext(data);
        	cb_if_auth_fail(msgs);
        	if( cb_if_is_fail(msgs) ){}
            else {
                vlanid = msgs.headers['vlan_id'];
                vlanqos = msgs.headers['vlan_qos'];
                layer3qossip = msgs.headers[':dscp2'];
                layer3qosaudio = msgs.headers[':dscp1'];
                layer3qosvideo = msgs.headers[':dscp7'];
            }
        },
        error:function(xmlHttpRequest, errorThrown) {
            cb_networkerror(xmlHttpRequest, errorThrown);
        }
    });

    if(vlanid != "" && vlanid != "0")
        $("#layer2qos").val(vlanid);
    
    if(vlanqos != "" && vlanqos != "0")
        $("#layer2qospv").val(vlanqos);
        
    if(layer3qossip != "")
        $("#layer3qossip").val(layer3qossip);
        
    if(layer3qosaudio != "")
        $("#layer3qosaudio").val(layer3qosaudio);
    
    if(layer3qosvideo != "")
        $("#layer3qosvideo").val(layer3qosvideo);
}

function init_uploadca(){
    var button = $('#a_uploadca'), interval;
    var uploadkeytimer = 0;
    new Ajax_upload(button,{
        name: 'file',
		action : '../upload?type=802ca',
        onSubmit : function(file, ext){
            cb_ping();
            //if (ext && new RegExp('^(' + allowed.join('|') + ')$').test(ext)){
            /*if (! (ext && /^(xml)$/.test(ext))){
                    alert('Error: invalid file extension');
                    return false;
            }*/
            // change button text, when user selects file           
            button.text(a_16431);
            button.addClass('widebtn');
            
            // If you want to allow uploading only 1 file at time, you can disable upload button
            this.disable();
            
            // Animating upload button, Uploding -> Uploading. -> Uploading...
            interval = window.setInterval(function(){
                var text = button.text();
                uploadkeytimer++;
                if (text.length < (a_16431.length + 3)){
                    button.text(text + '.');
                } else {
                    button.text(a_16431);
                }
                if (uploadkeytimer > 900)
                {
                     window.clearInterval(interval);
                     uploadkeytimer = 0;
                     $.prompt(a_16432);
                     button.text(a_7404);
                     button.removeClass('widebtn');
                }
            }, 200);
        },
        onComplete: function(file, response){
            //console.log(response);
            button.text(a_7404);
            button.removeClass('widebtn');
            window.clearInterval(interval);
            $("input[type='file']").attr("title", "");
            uploadkeytimer = 0;
			//dbussend_uploadphbook();
            
            // enable upload button
            this.enable();
        }
    });
}
function init_uploadclient(){
    var button = $('#a_uploadclient'), interval;
    var uploadkeytimer = 0;
    new Ajax_upload(button,{
        name: 'file',
		action : '../upload?type=802client',
        onSubmit : function(file, ext){
            cb_ping();
            //if (ext && new RegExp('^(' + allowed.join('|') + ')$').test(ext)){
            /*if (! (ext && /^(xml)$/.test(ext))){
                    alert('Error: invalid file extension');
                    return false;
            }*/
            // change button text, when user selects file           
            button.text(a_16431);
            button.addClass('widebtn');
           
            // If you want to allow uploading only 1 file at time, you can disable upload button
            this.disable();
            
            // Animating upload button, Uploding -> Uploading. -> Uploading...
            interval = window.setInterval(function(){
                var text = button.text();
                uploadkeytimer++;
                if (text.length < (a_16431.length + 3)){
                    button.text(text + '.');
                } else {
                    button.text(a_16431);
                }
                if (uploadkeytimer > 900)
                {
                     window.clearInterval(interval);
                     uploadkeytimer = 0;
                     $.prompt(a_16432);
                     button.text(a_7404);
                     button.removeClass('widebtn');
                }
            }, 200);
        },
        onComplete: function(file, response){
            //console.log(response);
            button.text(a_7404);
            button.removeClass('widebtn');
            window.clearInterval(interval);
            $("input[type='file']").attr("title", "");
            uploadkeytimer = 0;
			//dbussend_uploadphbook();
            
            // enable upload button
            this.enable();
        }
    });
}
function init_uploadprivkey(){
    var button = $('#a_uploadprivkey'), interval;
    var uploadkeytimer = 0;
    new Ajax_upload(button,{
        name: 'file',
		action : '../upload?type=802privatekey',
        onSubmit : function(file, ext){
            cb_ping();
            //if (ext && new RegExp('^(' + allowed.join('|') + ')$').test(ext)){
            /*if (! (ext && /^(xml)$/.test(ext))){
                    alert('Error: invalid file extension');
                    return false;
            }*/
            // change button text, when user selects file           
            button.text(a_16431);
            button.addClass('widebtn');
           
            // If you want to allow uploading only 1 file at time, you can disable upload button
            this.disable();
            
            // Animating upload button, Uploding -> Uploading. -> Uploading...
            interval = window.setInterval(function(){
                var text = button.text();
                uploadkeytimer++;
                if (text.length < (a_16431.length + 3)){
                    button.text(text + '.');
                } else {
                    button.text(a_16431);
                }
                if (uploadkeytimer > 900)
                {
                     window.clearInterval(interval);
                     uploadkeytimer = 0;
                     $.prompt(a_16432);
                     button.text(a_7404);
                     button.removeClass('widebtn');
                }
            }, 200);
        },
        onComplete: function(file, response){
            //console.log(response);
            button.text(a_7404);
            button.removeClass('widebtn');
            window.clearInterval(interval);
            $("input[type='file']").attr("title", "");
            uploadkeytimer = 0;
			//dbussend_uploadphbook();
            
            // enable upload button
            this.enable();
        }
    });
}

function init_openvpn(){
    var btnarr = new Array($("#vpncaupload"), $("#vpncertupload"), $("#vpnkeyupload"));
    for(var i in btnarr){
        new Ajax_upload(btnarr[i], {
            name: 'file',
            action : '../upload?type=vericert',
            onSubmit : function(file, ext) {
                var filetype = this._button.attributes["filetype"].value;
                console.log(this._button.attributes["filetype"].value);
                if(ext[0] != filetype){
                    $.prompt(a_16434);
                    return false;
                }
                cb_ping();
                window.parent.block_upload_func();
            },
            onComplete: function(file, response) {
                var btnid = this._button.id;
                var pvalue = "";
                switch (btnid) {
                    case 'vpncaupload':
                        pvalue = "9902"
                        break;
                    case 'vpncertupload':
                        pvalue = "9903"
                        break;
                    case 'vpnkeyupload':
                        pvalue = "9904"
                        break;
                }
                var action = "setopenvpncert&region=advanset&pvalue=" + pvalue;
                cb_get_action(action);
            }
        });
    }
    
    //init the status of delete buttons
    cb_get_action("get&var-0000=9902&var-0001=9903&var-0002=9904");
}

function init_uploadframe(){
    var button = $('#a_uploadframe'), interval;
    var uploadkeytimer = 0;
    var uploadobj = new Ajax_upload(button,{
        name: 'frameca',
		action : '../upload?type=frameca',
		onSubmit : function(file, ext){
            cb_ping();
            //if (ext && new RegExp('^(' + allowed.join('|') + ')$').test(ext)){
            /*if (! (ext && /^(xml)$/.test(ext))){
                    alert('Error: invalid file extension');
                    return false;
            }*/
            // change button text, when user selects file           
            button.text(a_16431);
            button.addClass('widebtn');
            
            // If you want to allow uploading only 1 file at time, you can disable upload button
            this.disable();
            
            // Animating upload button, Uploding -> Uploading. -> Uploading...
            interval = window.setInterval(function(){
                var text = button.text();
                uploadkeytimer++;
                if (text.length < (a_16431.length + 3)){
                    button.text(text + '.');
                } else {
                    button.text(a_16431);
                }
                if (uploadkeytimer > 900)
                {
                     window.clearInterval(interval);
                     uploadkeytimer = 0;
                     $.prompt(a_16432);
                     button.text(a_7404);
                     button.removeClass('widebtn');
                }
            }, 200);
        },
        onComplete: function(file, response){
            //console.log(response);
            button.text(a_7404);
            button.removeClass('widebtn');
            window.clearInterval(interval);
            $("input[type='file']").attr("title", "");
            uploadkeytimer = 0;
			cb_get_action('renameframecomp&region=advanset&filename='+encodeURIComponent(file));
            
            // enable upload button
            this.enable();
        }
    });
}
function cb_show_802_mode(){
    var mode = $("#xmode").val();
    if(mode == 0)
    {
        $("#identitydiv, #md5pasdiv").hide();
        $("#uploaddivpart1, #uploaddivpart3").hide();
        $("#uploaddivpart2").hide();
    }
    else if(mode == 1)
    {
        $("#md5pasdiv").attr("webtip", "802.1x Secret");
        $("#identitydiv, #md5pasdiv").show();
        $("#a_md5pas").text(a_16196);
        $("#uploaddivpart1, #uploaddivpart3").hide();
        $("#uploaddivpart2").hide();
    }
    else if(mode == 2)
    {
        $("#md5pasdiv").attr("webtip", "802.1x Private Key Password");
        $("#identitydiv, #md5pasdiv").show();
        $("#a_md5pas").text(a_4394);
        $("#uploaddivpart1, #uploaddivpart3").show();
        $("#uploaddivpart2").show();
    }
    else
    {
        $("#md5pasdiv").attr("webtip", "802.1x Secret");
        $("#identitydiv, #md5pasdiv").show();
        $("#a_md5pas").text(a_16196);
        $("#uploaddivpart1, #uploaddivpart3").hide();
        $("#uploaddivpart2").show();
    }
}

function set_ipv6_item_dis(val) {
    if (val == 0)
        $(".ipv6staticitem").hide();
    else
        $(".ipv6staticitem").show();
}

function cb_proxy_mode_change(){
    if($("#applyall").prop("checked") == true){
        $("#a_proxyftp").css('color','gray');
        $("#proxyftp").attr('disabled',true);
    }else{
        $("#a_proxyftp").css('color','');
        $("#proxyftp").attr('disabled',false);
    }
}
function cb_send_proxy_dbus(){
	var urihead = "action=proxyupdated&region=advanset";
    urihead += "&time=" + new Date().getTime();
    $.ajax ({
        type: 'get',
        url:'/manager',
        data:urihead,
        dataType:'text',
        success:function(data) {
            window.parent.unblock_func();
            //cb_put_suc();
        },
        error:function(xmlHttpRequest, errorThrown) {
            window.parent.unblock_func();
            cb_networkerror(xmlHttpRequest, errorThrown);
        }
    });
}
function checkIPFormatInvalid( ipstr )
{
    if( ipstr == "" ) return true;
    var re=/^(\d+)\.(\d+)\.(\d+)\.(\d+)$/;
    if(re.test(ipstr))   
    {   
        if( RegExp.$1<256 && RegExp.$2<256 && RegExp.$3<256 && RegExp.$4<256) 
            return true;   
    } 
    return false; 
}

function tobinary(n)
{
    var binstr = tobinChange(n);
    while( binstr.length % 8 != 0 ) {
        binstr = "0" + binstr;
    }
    return binstr;
}

function tobinChange(n)
{
    if(!isNaN(n) && n>0)
    {
        if(n%2==0)
        {
            return tobinChange(n/2)+"0";
        }
        else {
            if(n>2)
            {
                return tobinChange(parseInt(n/2))+(n%2);
            }
            else
            {
            return tobinChange(0)+n;
            }
        }
    }
    else
    {
        return "";
    }
}
function cb_put_network2()
{
    var urihead = "action=putnetwork&region=advanset";
    urihead += "&time=" + new Date().getTime();
    $.ajax ({
        type: 'get',
        url:'/manager',
        data:urihead,
        dataType:'text',
        success:function(data) {
            //cb_put_suc();
        },
        error:function(xmlHttpRequest, errorThrown) {
            cb_networkerror(xmlHttpRequest, errorThrown);
        }
    });
}

function do_ping() {
    var urihead = "action=ping";
    urihead += "&time=" + new Date().getTime();
    $.ajax ({
        type: 'get',
        timeout: 5000,
        url:'/manager',
        data:urihead,
        dataType:'text',
        success:function(data) {
            window.parent.unblock_func();
        },
        error:function(xmlHttpRequest, errorThrown) {
            do_ping();
        }
    });
}

function cb_put_suc(data, mode)
{
    var msgs = res_parse_rawtext(data);
	cb_if_auth_fail(msgs);
	if( cb_if_is_fail(msgs) ) 
	    view_message(a_16419, MSG_FAIL);
    else {
        /*cb_set_property(0, $("#dhcpop12").val());
        cb_set_property(1, $("#dhcpop60").val());
        cb_set_property(2, $("#dhcpop125").val());*/
        //cb_put_network2();
        //cb_send_proxy_dbus();
        setTimeout(function() {
           do_ping(); 
        }, 3000);
        view_message(a_16447, MSG_OK);
    }
    //checkIsApplyNeed();
    /*if (mode == "cfupdated") {
         dbussend_cfupdated();
    }*/
}
function cb_get_action_done(data, action) {
    var msgs = res_parse_rawtext(data);
    cb_if_auth_fail(msgs);
    
    if(action == "put&var-0000=1684&val-0000=0"){
        setTimeout("cb_get_action('get&var-0000=in_lldp');", 1000);
    }else if(action == "get&var-0000=in_lldp"){
        if( msgs.headers["in_lldp"] == "0" ){
            $("#openlldp").val("0");
            window.parent.unblock_func();
        }else{
            setTimeout("cb_get_action('get&var-0000=in_lldp');", 1000);
        }
    }else if(action == "get&var-0000=9902&var-0001=9903&var-0002=9904"){
        if(!msgs.headers['9902']){
            $("#vpncadel").prop("disabled", true);
        }
        if(!msgs.headers['9903']){
            $("#vpncertdel").prop("disabled", true);
        }
        if(!msgs.headers['9904']){
            $("#vpnkeydel").prop("disabled", true);
        }
    }else if(action.indexOf("setopenvpncert") != -1){
        window.parent.unblock_func();
        if(msgs.headers['response'] == "Success"){
            $.prompt(a_16476);
            if(action.indexOf("9902") != -1){
                $("#vpncadel").prop("disabled", false);
            }else if(action.indexOf("9903") != -1){
                $("#vpncertdel").prop("disabled", false);
            }else{
                $("#vpnkeydel").prop("disabled", false);
            }
        }else{
            $.prompt(a_16477);
        }
    }else if(action.indexOf("put&val-0000=&var-0000=990") != -1){
        $.prompt(a_57);
        if(action.indexOf("9902") != -1){
            $("#vpncadel").prop("disabled", true);
        }else if(action.indexOf("9903") != -1){
            $("#vpncertdel").prop("disabled", true);
        }else{
            $("#vpnkeydel").prop("disabled", true);
        }
    }
}
function pageEventActions(){
    $("#ppoepassword, #md5pas").hideShowPassword({
        innerToggle: true
    });
    
    $("#networktype").change(function(){
        var flag = parseInt($(this).val());
        cb_mode_change(flag);
    });
    $("#xmode").change(function(){
        cb_show_802_mode();
    }); 
    $("#enablelldp").click(function(){
        if( !$("#enablelldp").prop("checked") && $("#openlldp").val() == "1") {
            window.parent.block_download_func(a_8104);
            cb_get_action("put&var-0000=1684&val-0000=0");
        }else{
            cb_lldp_mode_change( $("#enablelldp").prop("checked") );
        }
    });
    $("#ipv6addr").change(function() {
        set_ipv6_item_dis($(this).val());
    });
    
    $("#vpncadel, #vpncertdel, #vpnkeydel").click(function(){
        var delnvarm = "";
        var btnid = $(this).attr("id");
        switch (btnid) {
            case "vpncadel":
                delnvarm = "9902";
                break;
            case "vpncertdel":
                delnvarm = "9903";
                break;
            case "vpnkeydel":
                delnvarm = "9904";
                break;
        }
        cb_get_action("put&val-0000=&var-0000=" + delnvarm);
    });
    
    $("#a_save").click(function(){
        var nettype = parseInt($("#networktype").val());
        if( nettype == "2") {
            if( $("#ppoeaccount").val() == "" || $("#ppoepassword").val() == "")
            {
                $.prompt(a_16446);
                return false;
            }
        }
        else if( nettype == "1" )
        {
            $("input[name=ipaddress]").rules("add", { required: true, digits: true, range:[0,255] });
            if( !$("input[name=ipaddress]").valid() )
            {
                view_message(a_16442,MSG_FAIL);
                return false;
            }
            $("#ipaddr1").val( parseInt($("#ipaddr1").val()) );
            $("#ipaddr2").val( parseInt($("#ipaddr2").val()) );
            $("#ipaddr3").val( parseInt($("#ipaddr3").val()) );
            $("#ipaddr4").val( parseInt($("#ipaddr4").val()) );
            if( $("#ipaddr1").val() == "0" && $("#ipaddr2").val() == "0" && $("#ipaddr3").val() == "0" && $("#ipaddr4").val() == "0" )
            {
                view_message(a_4246,MSG_FAIL);
                return false;
            }
            $("input[name=submask]").rules("add", { required: true, digits: true, range:[0,255] });
            if( !$("input[name=submask]").valid() )
            {
                view_message(a_16442,MSG_FAIL);
                return false;
            }
            $("#mask1").val( parseInt($("#mask1").val()) );
            $("#mask2").val( parseInt($("#mask2").val()) );
            $("#mask3").val( parseInt($("#mask3").val()) );
            $("#mask4").val( parseInt($("#mask4").val()) );
            var submaskbinarystr = tobinary($("#mask1").val()) + tobinary($("#mask2").val()) + tobinary($("#mask3").val()) + tobinary($("#mask4").val());
            var pos0 = submaskbinarystr.indexOf("0");
            if( pos0 >= 0 && pos0 < submaskbinarystr.lastIndexOf("1") )
            {
                view_message(a_4247,MSG_FAIL);
                return false;
            }
            $("input[name=dftgateway]").rules("add", { required: true, digits: true, range:[0,255] });
            if( !$("input[name=dftgateway]").valid() )
            {
                view_message(a_16442,MSG_FAIL);
                return false;
            }
            $("#gateway1").val( parseInt($("#gateway1").val()) );
            $("#gateway2").val( parseInt($("#gateway2").val()) );
            $("#gateway3").val( parseInt($("#gateway3").val()) );
            $("#gateway4").val( parseInt($("#gateway4").val()) );
            $("input[name=dnsserver1]").rules("add", { required: true, digits: true, range:[0,255] });
            if( !$("input[name=dnsserver1]").valid() )
            {
                view_message(a_16442,MSG_FAIL);
                return false;
            }
            $("#prednsser1").val( parseInt($("#prednsser1").val()) );
            $("#prednsser2").val( parseInt($("#prednsser2").val()) );
            $("#prednsser3").val( parseInt($("#prednsser3").val()) );
            $("#prednsser4").val( parseInt($("#prednsser4").val()) );
            if( $("input[name=dnsserver2]:filled").length > 0 )
		    {
		    	$("input[name=dnsserver2]").rules("add", { required: true, digits: true, range:[0,255] });
		        if( !$("input[name=dnsserver2]").valid() )
		        {
		            view_message(a_16442,MSG_FAIL);
		            return false;
		        } 
		    }else{
		        $("input[name=dnsserver2]").val("0");
		    }
		    $("#alerdnsser1").val( parseInt($("#alerdnsser1").val()) );
            $("#alerdnsser2").val( parseInt($("#alerdnsser2").val()) );
            $("#alerdnsser3").val( parseInt($("#alerdnsser3").val()) );
            $("#alerdnsser4").val( parseInt($("#alerdnsser4").val()) );
        }
        
        if( $("#relprednsser1").val() != "" || $("#relprednsser2").val() != "" || $("#relprednsser3").val() != "" || $("#relprednsser4").val() != "" ) {
            $("input[name=altserver]").rules("add", { required: true, digits: true, range:[0,255] });
            if( !$("input[name=altserver]").valid() )
            {
                view_message(a_16442,MSG_FAIL);
                return false;
            }
            $("#relprednsser1").val( parseInt($("#relprednsser1").val()) );
            $("#relprednsser2").val( parseInt($("#relprednsser2").val()) );
            $("#relprednsser3").val( parseInt($("#relprednsser3").val()) );
            $("#relprednsser4").val( parseInt($("#relprednsser4").val()) );
        }else{
            $("input[name=altserver]").rules("remove");
        }
        //if( $("input[name=secaltserver]").val() != "" ) {
        if( $("#secrelprednsser1").val() != "" || $("#secrelprednsser2").val() != "" || $("#secrelprednsser3").val() != "" || $("#secrelprednsser4").val() != "" ) {
            $("input[name=secaltserver]").rules("add", { required: true, digits: true, range:[0,255] });
            if( !$("input[name=secaltserver]").valid() )
            {
                view_message(a_16442,MSG_FAIL);
                return false;
            }
            $("#secrelprednsser1").val( parseInt($("#secrelprednsser1").val()) );
            $("#secrelprednsser2").val( parseInt($("#secrelprednsser2").val()) );
            $("#secrelprednsser3").val( parseInt($("#secrelprednsser3").val()) );
            $("#secrelprednsser4").val( parseInt($("#secrelprednsser4").val()) );
        }else{
            $("input[name=secaltserver]").rules("remove");
        }
        var tmpproxy = $("#proxyhttpurl").val();
        tmpproxy = $.trim(tmpproxy);
        var tmpport = $("#proxyhttpport").val();
        tmpport = $.trim(tmpport);
        var tmpnoproxy = $("#noproxy").val();
        tmpnoproxy = $.trim(tmpnoproxy);
        var proxys = tmpproxy.split(":");
        if( proxys.length == 2 ) {
            $.prompt(a_16444);
            return false;
        }
        if( (tmpproxy == "" && tmpport != "") || (tmpproxy != "" && tmpport == "") || (tmpnoproxy != "" && tmpproxy == "" && tmpport == "") ) {
            $.prompt(a_16445);
            return false;
        } 

        if ($("#ipv6addr").val() == 1) {
            $("#staticipv6addr").rules('add', {required: true, ipv6: true});
            $("#ipv6prefixlen").rules('add', {required: true, digits: true, range:[1,128]});
            if (!$("#staticipv6addr, #ipv6prefixlen").valid()) {
                view_message(a_16442,MSG_FAIL);
                return false;
            }
        } else {
            $("#staticipv6addr").rules('remove');
            $("#staticipv6addr").val(default_ipv6static);
            $("#ipv6prefixlen").rules('remove');
            $("#ipv6prefixlen").val(default_ipv6prefix);
        }

        if (!$("#Formvalidate").valid()) {
            view_message(a_16442,MSG_FAIL);
            return false;
        }
        /*if( parseInt( parseInt( $("#dhcpop12").val().length ) + parseInt( $("#dhcpop60").val().length ) ) >= 25 )
        {
            $.prompt(a_16479);
        }*/
        if( tmpport != "" ) {
            $("#proxyhttp").val(tmpproxy+":"+tmpport);
            $("#proxyhttps").val(tmpproxy+":"+tmpport);
        } else {
            $("#proxyhttp").val(tmpproxy);
            $("#proxyhttps").val(tmpproxy);
        }
        if($("#applyall").prop("checked") == true) {
            $("#proxyftp").val(tmpproxy);
        }
        
        if($("#enablelldp").prop("checked") && $("#openlldp").val() == "1"){
            var done = 0;
            for(var i = 0; i < req_items.length; i++){
                if(req_items[i].id == "layer2qos"){
                    req_items[i].pvalue = "vlan_id";
                    done ++;
                }
                else if(req_items[i].id == "layer2qospv"){
                    req_items[i].pvalue = "vlan_qos";
                    done ++;
                }
                else if(req_items[i].id == "layer3qossip"){
                    req_items[i].pvalue = ":dscp2";
                    done++;
                }
                else if(req_items[i].id == "layer3qosaudio"){
                    req_items[i].pvalue = ":dscp1";
                    done++;
                }
                else if(req_items[i].id == "layer3qosvideo"){
                    req_items[i].pvalue = ":dscp7";
                    done++;
                }
                
                if(done == 5)
                    break;
            }
        }

        cb_put(req_items, "", 0);
        window.parent.block_download_func(a_19238);
    });
}
</script>

</body>

</html>
